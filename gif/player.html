<!DOCTYPE html>
<html>
<head>
  <style>
    /* Optional: Global styles for the component */
    gif-player {
      display: inline-block;
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      background: #000;
    }
  </style>
</head>
<body>

  <!-- Example Usage -->
  <h1>GIF Player Web Component</h1>

  <gif-player 
    src="https://media.giphy.com/media/l0HlRnAWXxn0MhKLK/giphy.gif" 
    alt="Yes!"
    width="300">
  </gif-player>

  <br><br>

  <gif-player 
    src="https://media.giphy.com/media/Ju7l5y9inhSMQ8AQ7p/giphy.gif" 
    alt="Loading..."
    hover-play
    width="200">
  </gif-player>

  <script>
    class GifPlayer extends HTMLElement {
      constructor() {
        super();
        this.isPlaying = false;
        this.hoverPlay = this.hasAttribute('hover-play');
        this.attachShadow({ mode: 'open' });
      }

      static get observedAttributes() {
        return ['src', 'alt', 'width', 'height'];
      }

      attributeChangedCallback() {
        this.render();
      }

      connectedCallback() {
        this.render();
        this.setupEvents();
      }

      render() {
        const src = this.getAttribute('src') || '';
        const alt = this.getAttribute('alt') || 'GIF';
        const width = this.getAttribute('width') || '100%';
        const height = this.getAttribute('height') || 'auto';

        this.shadowRoot.innerHTML = `
          <style>
            :host {
              display: inline-block;
              position: relative;
              cursor: pointer;
              border-radius: 12px;
              overflow: hidden;
            }
            .container {
              position: relative;
              display: inline-block;
              width: ${width};
              height: ${height};
            }
            img {
              width: 100%;
              height: 100%;
              object-fit: cover;
              display: block;
              border-radius: 12px;
            }
            .overlay {
              position: absolute;
              inset: 0;
              background: rgba(0,0,0,0.4);
              display: flex;
              align-items: center;
              justify-content: center;
              opacity: 0;
              transition: opacity 0.3s ease;
              border-radius: 12px;
            }
            :host(:hover) .overlay,
            .overlay.visible {
              opacity: 1;
            }
            .play-button {
              width: 68px;
              height: 68px;
              background: rgba(255,255,255,0.9);
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              box-shadow: 0 4px 20px rgba(0,0,0,0.4);
              transition: all 0.2s ease;
            }
            .play-button:hover {
              transform: scale(1.1);
              background: white;
            }
            .play-button svg {
              width: 28px;
              height: 28px;
              fill: #000;
              margin-left: 4px;
            }
            .pause-icon {
              width: 24px;
              height: 24px;
              background: #000;
              border-radius: 2px;
              position: relative;
            }
            .pause-icon::before,
            .pause-icon::after {
              content: '';
              position: absolute;
              top: 4px;
              bottom: 4px;
              width: 6px;
              background: white;
              border-radius: 2px;
            }
            .pause-icon::before { left: 5px; }
            .pause-icon::after { right: 5px; }

            .loading {
              position: absolute;
              inset: 0;
              background: #000;
              display: flex;
              align-items: center;
              justify-content: center;
            }
            .spinner {
              width: 40px;
              height: 40px;
              border: 4px solid #333;
              border-top: 4px solid #fff;
              border-radius: 50%;
              animation: spin 1s linear infinite;
            }
            @keyframes spin {
              to { transform: rotate(360deg); }
            }
          </style>

          <div class="container">
            <div class="loading" id="loading">
              <div class="spinner"></div>
            </div>

            <img id="gif" 
                 src="${src}" 
                 alt="${alt}" 
                 loading="lazy">

            <div class="overlay" id="overlay">
              <div class="play-button" id="play-btn">
                <svg viewBox="0 0 24 24" id="play-icon">
                  <path d="M8 5v14l11-7z"/>
                </svg>
                <div class="pause-icon" id="pause-icon" style="display:none"></div>
              </div>
            </div>
          </div>
        `;

        // Setup after render
        const img = this.shadowRoot.getElementById('gif');
        const loading = this.shadowRoot.getElementById('loading');
        const overlay = this.shadowRoot.getElementById('overlay');
        const playIcon = this.shadowRoot.getElementById('play-icon');
        const pauseIcon = this.shadowRoot.getElementById('pause-icon');

        img.onload = () => {
          loading.style.display = 'none';
          this.isPlaying = true; // Start playing by default
          this.updatePlayState(playIcon, pauseIcon);
        };

        img.onerror = () => {
          loading.innerHTML = '<div style="color:white;">Failed to load GIF</div>';
        };
      }

      updatePlayState(playIcon, pauseIcon) {
        if (this.isPlaying) {
          playIcon.style.display = 'none';
          pauseIcon.style.display = 'block';
        } else {
          playIcon.style.display = 'block';
          pauseIcon.style.display = 'none';
        }
      }

      setupEvents() {
        const img = this.shadowRoot.getElementById('gif');
        const overlay = this.shadowRoot.getElementById('overlay');
        const playBtn = this.shadowRoot.getElementById('play-btn');
        const playIcon = this.shadowRoot.getElementById('play-icon');
        const pauseIcon = this.shadowRoot.getElementById('pause-icon');

        const toggle = () => {
          if (!img.src) return;

          if (this.isPlaying) {
            img.src = img.src; // Restart animation
            this.isPlaying = true;
          } else {
            const staticSrc = img.src.replace(/\.gif(\?.*)?$/i, '.webp') || 
                              img.src + '?format=static';
            img.src = staticSrc;
            this.isPlaying = false;
          }
          this.updatePlayState(playIcon, pauseIcon);
        };

        overlay.addEventListener('click', (e) => {
          e.stopPropagation();
          toggle();
        });

        // Hover to play
        if (this.hoverPlay) {
          this.addEventListener('mouseenter', () => {
            if (!this.isPlaying) toggle();
          });
          this.addEventListener('mouseleave', () => {
            if (this.isPlaying && !this.hasAttribute('paused')) {
              toggle();
            }
          });
        }
      }
    }

    // Register the component
    customElements.define('gif-player', GifPlayer);
  </script>

  <h2>More Examples</h2>
  <gif-player src="https://media.giphy.com/media/26ufnwz3wDUli7GU0/giphy.gif" width="350" hover-play></gif-player>
  <gif-player src="https://media.giphy.com/media/xThta8x613igp7Hxbk/giphy.gif" width="250"></gif-player>

</body>
</html>