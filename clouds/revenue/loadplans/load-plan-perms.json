[
  {
    "object": "Profile",
    "compositeKeys": ["Id"],
    "description": "Baseline user profiles and their system-level permissions",
    "query": "SELECT Id, Name, UserLicense.Name, PermissionsModifyAllData, PermissionsViewAllData, PermissionsManageUsers, PermissionsApiEnabled FROM Profile",
    "fieldMappings": {
      "Id": "Id",
      "Name": "Name",
      "UserLicenseName": "UserLicense.Name",
      "PermissionsModifyAllData": "PermissionsModifyAllData",
      "PermissionsViewAllData": "PermissionsViewAllData",
      "PermissionsManageUsers": "PermissionsManageUsers",
      "PermissionsApiEnabled": "PermissionsApiEnabled"
    }
  },

  {
    "object": "PermissionSet",
    "compositeKeys": ["Id"],
    "description": "All permission sets including system and administrative permissions",
    "query": "SELECT Id, Name, Label, IsOwnedByProfile, PermissionsModifyAllData, PermissionsViewAllData, PermissionsManageUsers, PermissionsAuthorApex, PermissionsCustomizeApplication FROM PermissionSet",
    "fieldMappings": {
      "Id": "Id",
      "Name": "Name",
      "Label": "Label",
      "IsOwnedByProfile": "IsOwnedByProfile",
      "PermissionsModifyAllData": "PermissionsModifyAllData",
      "PermissionsViewAllData": "PermissionsViewAllData",
      "PermissionsManageUsers": "PermissionsManageUsers",
      "PermissionsAuthorApex": "PermissionsAuthorApex",
      "PermissionsCustomizeApplication": "PermissionsCustomizeApplication"
    }
  },

  {
    "object": "PermissionSetGroup",
    "compositeKeys": ["Id"],
    "description": "Permission set groups used to bundle permission sets",
    "query": "SELECT Id, DeveloperName, MasterLabel, Description, Status FROM PermissionSetGroup",
    "fieldMappings": {
      "Id": "Id",
      "DeveloperName": "DeveloperName",
      "MasterLabel": "MasterLabel",
      "Description": "Description",
      "Status": "Status"
    }
  },

  {
    "object": "PermissionSetGroupComponent",
    "compositeKeys": ["PermissionSetGroupId", "PermissionSetId"],
    "description": "Maps permission sets included in each permission set group",
    "query": "SELECT PermissionSetGroupId, PermissionSetGroup.DeveloperName, PermissionSetId,  PermissionSet.Name FROM PermissionSetGroupComponent",
    "fieldMappings": {
      "PermissionSetGroupId": "PermissionSetGroupId",
      "PermissionSetId": "PermissionSetId",
      "PermissionSetName": "PermissionSet.Name"
    }
  },

  {
    "object": "PermissionSetAssignment",
    "compositeKeys": ["Id"],
    "description": "All permission set assignments including those originating from permission set groups",
    "query": "SELECT Id, AssigneeId, Assignee.Username, PermissionSetId, PermissionSet.Name, PermissionSet.Description, PermissionSetGroupId FROM PermissionSetAssignment",
    "fieldMappings": {
      "Id": "Id",
      "AssigneeId": "AssigneeId",
      "AssigneeUsername": "Assignee.Username",
      "PermissionSetId": "PermissionSetId",
      "PermissionSetName": "PermissionSet.Name",
      "PermissionSetGroupId": "PermissionSetGroupId"
    }
  },

  {
    "object": "User",
    "compositeKeys": ["Username"],
    "description": "All users with profile, role, and login metadata",
    "query": "SELECT Id, Name, Username, Email, IsActive, ProfileId, Profile.Name, UserRoleId, LastLoginDate, CreatedDate FROM User",
    "fieldMappings": {
      "Id": "Id",
      "Name": "Name",
      "Username": "Username",
      "Email": "Email",
      "IsActive": "IsActive",
      "ProfileId": "ProfileId",
      "ProfileName": "Profile.Name",
      "UserRoleId": "UserRoleId",
      "LastLoginDate": "LastLoginDate",
      "CreatedDate": "CreatedDate"
    }
  },

  {
    "object": "ObjectPermissions",
    "compositeKeys": ["ParentId", "SobjectType"],
    "description": "Object-level permissions granted via profiles and permission sets",
    "query": "SELECT ParentId, Parent.Name,Parent.Label, SobjectType, PermissionsRead, PermissionsCreate, PermissionsEdit, PermissionsDelete, PermissionsViewAllRecords, PermissionsModifyAllRecords FROM ObjectPermissions",
    "fieldMappings": {
      "ParentId": "ParentId",
      "SobjectType": "SobjectType",
      "PermissionsRead": "PermissionsRead",
      "PermissionsCreate": "PermissionsCreate",
      "PermissionsEdit": "PermissionsEdit",
      "PermissionsDelete": "PermissionsDelete",
      "PermissionsViewAllRecords": "PermissionsViewAllRecords",
      "PermissionsModifyAllRecords": "PermissionsModifyAllRecords"
    }
  },

  {
    "object": "FieldPermissions",
    "compositeKeys": ["ParentId", "Field"],
    "description": "Field-level permissions granted via profiles and permission sets",
    "query": "SELECT ParentId,Parent.Name,Parent.Label, SobjectType, Field, PermissionsRead, PermissionsEdit FROM FieldPermissions",
    "fieldMappings": {
      "ParentId": "ParentId",
      "SobjectType": "SobjectType",
      "Field": "Field",
      "PermissionsRead": "PermissionsRead",
      "PermissionsEdit": "PermissionsEdit"
    }
  },

  {
    "object": "UserRole",
    "compositeKeys": ["Id"],
    "description": "Role hierarchy used for implicit record access",
    "query": "SELECT Id, Name, ParentRoleId, ParentRole.Name FROM UserRole",
    "fieldMappings": {
      "Id": "Id",
      "Name": "Name",
      "ParentRoleId": "ParentRoleId",
      "ParentRoleName": "ParentRole.Name"
    }
  },

  {
    "object": "LoginHistory",
    "compositeKeys": ["Id"],
    "description": "User login activity from the last 7 days",
    "query": "SELECT Id, UserId, LoginTime, Status, SourceIp, Application FROM LoginHistory WHERE LoginTime = LAST_N_DAYS:7",
    "fieldMappings": {
      "Id": "Id",
      "UserId": "UserId",
      "LoginTime": "LoginTime",
      "Status": "Status",
      "SourceIp": "SourceIp",
      "Application": "Application"
    }
  }
]
