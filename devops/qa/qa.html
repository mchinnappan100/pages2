<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Salesforce Metadata Deployment – Q & A</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #0f172a;
    }
    .splitter {
      width: 6px;
      cursor: col-resize;
      background: linear-gradient(
        to bottom,
        #334155,
        #475569,
        #334155
      );
      transition: background 0.2s;
    }
    .splitter:hover {
      background: #64748b;
    }
  </style>
</head>

<body class="h-screen overflow-hidden text-slate-200">

  <!-- Header -->
  <header class="px-6 py-4 border-b border-slate-700">
    <h1 class="text-2xl font-semibold text-sky-400">
      Salesforce Metadata Deployment – Q & A
    </h1>
    <p class="text-sm text-slate-400 mt-1">
      Common deployment errors, root causes, and proven fixes
    </p>
  </header>

  <!-- Main Layout -->
  <div id="container" class="flex h-[calc(100vh-80px)]">

    <!-- Left Pane -->
    <aside id="leftPane" class="w-1/3 min-w-[260px] max-w-[500px] border-r border-slate-700 overflow-y-auto">
      <ul class="divide-y divide-slate-700">

        <li class="p-4 hover:bg-slate-800 cursor-pointer" onclick="showAnswer('staticFiles')">
          <h3 class="font-medium text-sky-300">
            Static files are mentioned in package.xml but missing in zip
          </h3>
        </li>

        <li class="p-4 hover:bg-slate-800 cursor-pointer" onclick="showAnswer('objectMissing')">
          <h3 class="font-medium text-sky-300">
            An object was named in package.xml but not found in zipped directory
          </h3>
        </li>

        <li class="p-4 hover:bg-slate-800 cursor-pointer" onclick="showAnswer('apiVersion')">
          <h3 class="font-medium text-sky-300">
            API version mismatch during deployment
          </h3>
        </li>

        <li class="p-4 hover:bg-slate-800 cursor-pointer" onclick="showAnswer('profiles')">
          <h3 class="font-medium text-sky-300">
            Profile or Permission Set deployment failures
          </h3>
        </li>

        <li class="p-4 hover:bg-slate-800 cursor-pointer" onclick="showAnswer('destructive')">
          <h3 class="font-medium text-sky-300">
            Destructive changes not applied
          </h3>
        </li>

      </ul>
    </aside>

    <!-- Splitter -->
    <div id="splitter" class="splitter"></div>

    <!-- Right Pane -->
    <main id="rightPane" class="flex-1 p-6 overflow-y-auto">

      <!-- Static Files -->
      <section id="staticFiles" class="answer hidden">
        <h2 class="text-xl font-semibold text-emerald-400 mb-3">
          Static files are mentioned in package.xml but missing in zip
        </h2>

        <p class="mb-4 text-slate-300">
          This error occurs when <code class="text-sky-300">StaticResource</code>,
          <code class="text-sky-300">Documents</code>, or other static metadata types
          are declared in <code>package.xml</code> but the actual files are not included
          in the deployment ZIP.
        </p>

        <h3 class="font-semibold text-slate-100 mb-2">Common Causes</h3>
        <ul class="list-disc ml-6 mb-4 text-slate-300">
          <li>The staticfiles are mentioned in the .gitgnore or .forceignore</li>
          <li>Files were not pulled from source org</li>
          <li>Incorrect folder structure in the zip</li>
          <li>Using <code>*</code> wildcard without fetching metadata</li>
        </ul>

        <h3 class="font-semibold text-slate-100 mb-2">How to Fix</h3>
        <ul class="list-disc ml-6 text-slate-300">
          <li>Make sure the static files NOT are mentioned in the .gitgnore or .forceignore</li>
          <li>Ensure static resources exist under <code>staticresources/</code></li>
          <li>Verify both <code>.resource</code> and <code>.resource-meta.xml</code> files exist</li>
          <li>Run <code>sf project retrieve start</code> before deployment</li>
        </ul>
      </section>

      <!-- Object Missing -->
      <section id="objectMissing" class="answer hidden">
        <h2 class="text-xl font-semibold text-emerald-400 mb-3">
          Object was named in package.xml but not found in zipped directory
        </h2>

        <p class="mb-4 text-slate-300">
          Salesforce validates that every metadata component declared in
          <code>package.xml</code> exists physically in the deployment bundle.
        </p>

        <h3 class="font-semibold text-slate-100 mb-2">Typical Reasons</h3>
        <ul class="list-disc ml-6 mb-4 text-slate-300">
          <li>Object deleted or renamed in source org</li>
          <li>Partial retrieval of metadata</li>
          <li>Custom object folder missing under <code>objects/</code></li>
        </ul>

        <h3 class="font-semibold text-slate-100 mb-2">Resolution Steps</h3>
        <ul class="list-disc ml-6 text-slate-300">
          <li>Confirm object exists in the source org</li>
          <li>Re-retrieve the object using explicit API name</li>
          <li>Ensure <code>ObjectName.object-meta.xml</code> is present</li>
        </ul>
      </section>

      <!-- API Version -->
      <section id="apiVersion" class="answer hidden">
        <h2 class="text-xl font-semibold text-emerald-400 mb-3">
          API version mismatch during deployment
        </h2>

        <p class="mb-4 text-slate-300">
          Metadata retrieved with a higher API version may fail when deployed
          to an org that does not support it.
        </p>

        <h3 class="font-semibold text-slate-100 mb-2">Best Practices</h3>
        <ul class="list-disc ml-6 text-slate-300">
          <li>Align project API version with target org</li>
          <li>Avoid preview API versions</li>
          <li>Standardize API version across CI pipelines</li>
        </ul>
      </section>

      <!-- Profiles -->
      <section id="profiles" class="answer hidden">
        <h2 class="text-xl font-semibold text-emerald-400 mb-3">
          Profile or Permission Set deployment failures
        </h2>

        <p class="mb-4 text-slate-300">
          Profiles often reference components that do not exist in the target org,
          causing deployment failures.
        </p>

        <h3 class="font-semibold text-slate-100 mb-2">Recommended Approach</h3>
        <ul class="list-disc ml-6 text-slate-300">
          <li>Prefer Permission Sets over Profiles</li>
          <li>Split profiles into smaller logical units</li>
          <li>Remove references to unavailable fields or objects</li>
        </ul>
      </section>

      <!-- Destructive -->
      <section id="destructive" class="answer hidden">
        <h2 class="text-xl font-semibold text-emerald-400 mb-3">
          Destructive changes not applied
        </h2>

        <p class="mb-4 text-slate-300">
          Destructive changes require correct naming and placement to execute
          successfully.
        </p>

        <h3 class="font-semibold text-slate-100 mb-2">Checklist</h3>
        <ul class="list-disc ml-6 text-slate-300">
          <li>File name must be <code>destructiveChanges.xml</code></li>
          <li>Must be paired with a valid <code>package.xml</code></li>
          <li>Deploy using Metadata API (not change sets)</li>
        </ul>
      </section>

      <p id="placeholder" class="text-slate-500">
        Select a question from the left panel to view details.
      </p>

    </main>
  </div>

  <script>
    const answers = document.querySelectorAll('.answer');
    const placeholder = document.getElementById('placeholder');

    function showAnswer(id) {
      answers.forEach(a => a.classList.add('hidden'));
      placeholder.classList.add('hidden');
      document.getElementById(id).classList.remove('hidden');
    }

    // Splitter logic
    const splitter = document.getElementById('splitter');
    const leftPane = document.getElementById('leftPane');

    let isDragging = false;

    splitter.addEventListener('mousedown', () => {
      isDragging = true;
      document.body.style.cursor = 'col-resize';
    });

    window.addEventListener('mousemove', (e) => {
      if (!isDragging) return;
      const newWidth = e.clientX;
      leftPane.style.width = newWidth + 'px';
    });

    window.addEventListener('mouseup', () => {
      isDragging = false;
      document.body.style.cursor = 'default';
    });
  </script>

</body>
</html>
