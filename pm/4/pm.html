<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Maple - Project Management Suite</title><link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);min-height:100vh;color:#333}.container{max-width:1400px;margin:0 auto;padding:20px;background:rgba(255,255,255,.95);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.1);backdrop-filter:blur(10px);margin-top:20px;margin-bottom:20px}.header{text-align:center;margin-bottom:30px;padding:20px 0;border-bottom:3px solid #667eea}.header h1{font-size:2.5em;background:linear-gradient(45deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}.toolbar{display:flex;gap:15px;margin-bottom:30px;flex-wrap:wrap;align-items:center;padding:20px;background:linear-gradient(135deg,#f5f7fa 0,#c3cfe2 100%);border-radius:15px;box-shadow:inset 0 2px 4px rgba(0,0,0,.1)}.btn{padding:12px 24px;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all .3s cubic-bezier(.4, 0, .2, 1);text-transform:uppercase;letter-spacing:.5px;position:relative;overflow:hidden}.btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);transition:left .5s}.btn:hover::before{left:100%}.btn-primary{background:linear-gradient(45deg,#667eea,#764ba2);color:#fff;box-shadow:0 4px 15px rgba(102,126,234,.4)}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(102,126,234,.6)}.btn-secondary{background:linear-gradient(45deg,#ffecd2,#fcb69f);color:#333;box-shadow:0 4px 15px rgba(252,182,159,.4)}.btn-success{background:linear-gradient(45deg,#a8edea,#fed6e3);color:#333;box-shadow:0 4px 15px rgba(168,237,234,.4)}.tabs{display:flex;margin-bottom:20px;background:rgba(255,255,255,.8);border-radius:10px;padding:5px;box-shadow:0 2px 10px rgba(0,0,0,.1)}.tab{flex:1;padding:15px 20px;background:0 0;border:none;cursor:pointer;border-radius:8px;font-weight:600;transition:all .3s ease;position:relative}.tab.active{background:linear-gradient(45deg,#667eea,#764ba2);color:#fff;transform:scale(1.05)}.tab-content{display:none;background:rgba(255,255,255,.9);border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.1)}.tab-content.active{display:block;animation:fadeIn .5s ease-in-out}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.form-group{margin-bottom:20px}.form-group label{display:block;margin-bottom:8px;font-weight:600;color:#555}.form-group input,.form-group select,.form-group textarea{width:100%;padding:12px 16px;border:2px solid #e1e5e9;border-radius:8px;font-size:14px;transition:all .3s ease;background:rgba(255,255,255,.9)}.form-group input:focus,.form-group select:focus,.form-group textarea:focus{outline:0;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1);transform:translateY(-1px)}.task-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:20px;margin-top:20px}.task-card{background:linear-gradient(135deg,#fff 0,#f8f9ff 100%);border-radius:15px;padding:25px;box-shadow:0 8px 25px rgba(0,0,0,.1);border-left:5px solid #667eea;transition:all .3s ease;position:relative;overflow:hidden}.task-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,rgba(102,126,234,.05) 0,rgba(118,75,162,.05) 100%);opacity:0;transition:opacity .3s ease;pointer-events:none}.task-card:hover::before{opacity:1}.task-card:hover{transform:translateY(-5px);box-shadow:0 15px 35px rgba(0,0,0,.15)}.task-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.task-title{font-size:1.2em;font-weight:700;color:#333}.task-status{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase}.status-not-started{background:#ffeaa7;color:#2d3436}.status-in-progress{background:#74b9ff;color:#fff}.status-completed{background:#00b894;color:#fff}.status-delayed{background:#e17055;color:#fff}.progress-bar{width:100%;height:8px;background:#e1e5e9;border-radius:4px;overflow:hidden;margin:15px 0}.progress-fill{height:100%;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:4px;transition:width .3s ease}.gantt-container{overflow-x:auto;background:#fff;border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,.1)}.gantt-chart{min-width:800px;padding:20px}.gantt-header{display:grid;grid-template-columns:var(--gantt-columns,200px repeat(30,30px));gap:1px;align-items:center}.gantt-row{display:grid;grid-template-columns:var(--gantt-columns,200px repeat(30,30px));gap:1px;align-items:center}.gantt-task-name{padding:10px;font-weight:600;background:#f8f9fa;border-radius:5px}.gantt-day{height:30px;border:1px solid #e1e5e9;display:flex;align-items:center;justify-content:center;font-size:12px;background:#f8f9fa}.gantt-bar{height:25px;border-radius:12px;margin:2px 0;position:relative;overflow:hidden;border:2px solid #333}.gantt-bar::after{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:shimmer 2s infinite}@keyframes shimmer{0%{left:-100%}100%{left:100%}}.resources-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px}.resource-card{background:#fff;border-radius:15px;padding:20px;box-shadow:0 4px 15px rgba(0,0,0,.1);transition:transform .3s ease}.resource-card:hover{transform:translateY(-3px)}.file-upload{border:2px dashed #667eea;border-radius:15px;padding:40px;text-align:center;background:rgba(102,126,234,.05);transition:all .3s ease;cursor:pointer}.file-upload:hover{border-color:#764ba2;background:rgba(118,75,162,.1)}.file-upload input{display:none}.reports-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px;margin-top:20px}.chart-container{background:#fff;border-radius:15px;padding:25px;box-shadow:0 8px 25px rgba(0,0,0,.1)}.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.7);backdrop-filter:blur(5px)}.modal-content{background:#fff;margin:5% auto;padding:30px;border-radius:20px;width:90%;max-width:600px;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:modalSlideIn .3s ease-out;max-height:90vh;overflow-y:auto}@keyframes modalSlideIn{from{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}.close{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer;transition:color .3s ease}.close:hover{color:#667eea}.notification{position:fixed;top:20px;right:20px;padding:15px 25px;background:linear-gradient(45deg,#00b894,#00a085);color:#fff;border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,.2);z-index:1001;transform:translateX(400px);transition:transform .3s ease}.notification.show{transform:translateX(0)}@media (max-width:768px){.container{margin:10px;padding:15px}.toolbar{flex-direction:column;align-items:stretch}.tabs{flex-direction:column}.gantt-header,.gantt-row{grid-template-columns:150px repeat(15,25px)}}.file-upload.dragover{background:rgba(102,126,234,.15);border-color:#764ba2}.app-footer{position:sticky;bottom:0;width:100%;background:linear-gradient(90deg,#667eea 0,#764ba2 100%);color:#fff;text-align:center;padding:18px 0 12px 0;font-size:1.1em;font-weight:600;letter-spacing:1px;border-top-left-radius:18px;border-top-right-radius:18px;box-shadow:0 -2px 12px rgba(102,126,234,.08);z-index:100;margin-top:30px}</style></head><body><div class="container"><div class="header"><span style="font-size:2.2em;vertical-align:middle">üçÅ</span><h2 style="display:inline;margin-left:10px;vertical-align:middle">Maple - Project Management Suite <a href="javascript:void(0);" class="btn" style="font-size:.6em;margin-left:18px;vertical-align:middle;text-decoration:none" onclick="openHelpModal()">‚ùì Help</a></h2></div><div style="margin-bottom:20px;text-align:center"><label for="projectName" style="font-weight:700;margin-right:10px">Project Name:</label> <input id="projectName" value="Sample Project" style="padding:8px 16px;border-radius:8px;border:2px solid #e1e5e9;font-size:1.1em;width:300px;max-width:90%" oninput="updateProjectName(this.value)"></div><div class="toolbar"><button class="btn btn-primary" onclick='openModal("taskModal")'>Add Task</button> <button class="btn btn-secondary" onclick='openModal("resourceModal")'>Add Resource</button> <button class="btn btn-success" onclick="exportProject()">Export JSON</button><div class="file-upload" onclick='document.getElementById("importFile").click()'><input type="file" id="importFile" accept=".json" onchange="importProject(event)"> <span>Import/Drop JSON Project</span></div><button class="btn btn-primary" onclick="generateReport()">Generate Report</button> <button class="btn btn-secondary" onclick="exportSmartSheetsCSV()">Export SmartSheets CSV</button></div><div class="tabs"><button class="tab active" onclick='showTab("tasks")'>üìù Tasks</button> <button class="tab" onclick='showTab("gantt")'>üìä Gantt Chart</button> <button class="tab" onclick='showTab("resources")'>üë• Resources</button> <button class="tab" onclick='showTab("reports")'>üìà Reports</button> <button class="tab" onclick='showTab("calendar")'>üìÖ Calendar</button></div><div id="tasks" class="tab-content active"><h2>Task Management</h2><div class="task-grid" id="taskGrid"></div></div><div id="gantt" class="tab-content"><h2>Gantt Chart</h2><div class="gantt-container"><div class="gantt-chart" id="ganttChart"></div></div></div><div id="resources" class="tab-content"><h2>Resource Management</h2><div class="resources-grid" id="resourcesGrid"></div></div><div id="reports" class="tab-content"><h2>Reports & Analytics</h2><div class="reports-container" id="reportsContainer"></div></div><div id="calendar" class="tab-content"><h2>Project Calendar</h2><button class="btn btn-success" onclick="printCalendarPDF()" style="margin-bottom:15px">Print Calendar as PDF</button><div id="calendarView"></div></div></div><div id="taskModal" class="modal"><div class="modal-content"><span class="close" onclick='closeModal("taskModal")'>&times;</span><h2>Add/Edit Task</h2><form id="taskForm"><div class="form-group"><label for="taskName">Task Name:</label> <input id="taskName" required></div><div class="form-group"><label for="taskDescription">Description:</label> <textarea id="taskDescription" rows="3"></textarea></div><div class="form-group"><label for="taskStartDate">Start Date:</label> <input type="date" id="taskStartDate" required></div><div class="form-group"><label for="taskEndDate">End Date:</label> <input type="date" id="taskEndDate" required></div><div class="form-group"><label for="taskDuration">Duration (days):</label> <input type="number" id="taskDuration" min="1"></div><div class="form-group"><label for="taskPriority">Priority:</label> <select id="taskPriority"><option value="low">Low</option><option value="medium" selected="selected">Medium</option><option value="high">High</option><option value="critical">Critical</option></select></div><div class="form-group"><label for="taskStatus">Status:</label> <select id="taskStatus"><option value="not-started">Not Started</option><option value="in-progress">In Progress</option><option value="completed">Completed</option><option value="delayed">Delayed</option></select></div><div class="form-group"><label for="taskProgress">Progress (%):</label> <input type="range" id="taskProgress" min="0" max="100" value="0" oninput="updateProgressLabel(this.value)"> <span id="progressLabel">0%</span></div><div class="form-group"><label for="taskAssignee">Assignee:</label> <select id="taskAssignee"><option value="">Select Assignee</option></select></div><div class="form-group"><label for="taskDependencies">Dependencies:</label> <select id="taskDependencies" multiple="multiple"></select></div><button type="submit" class="btn btn-primary">Save Task</button></form></div></div><div id="resourceModal" class="modal"><div class="modal-content"><span class="close" onclick='closeModal("resourceModal")'>&times;</span><h2>Add/Edit Resource</h2><form id="resourceForm"><div class="form-group"><label for="resourceName">Resource Name:</label> <input id="resourceName" required></div><div class="form-group"><label for="resourceType">Type:</label> <select id="resourceType"><option value="human">Human Resource</option><option value="equipment">Equipment</option><option value="material">Material</option><option value="budget">Budget</option></select></div><div class="form-group"><label for="resourceRate">Rate (per hour/day):</label> <input type="number" id="resourceRate" step="0.01"></div><div class="form-group"><label for="resourceAvailability">Availability (%):</label> <input type="range" id="resourceAvailability" min="0" max="100" value="100" oninput="updateAvailabilityLabel(this.value)"> <span id="availabilityLabel">100%</span></div><div class="form-group"><label for="resourceSkills">Skills/Capabilities:</label> <textarea id="resourceSkills" rows="3"></textarea></div><button type="submit" class="btn btn-primary">Save Resource</button></form></div></div><div id="helpModal" class="modal" style="display:none"><div class="modal-content" style="max-width:900px;width:95vw;height:90vh;position:relative"><span class="close" onclick="closeHelpModal()" style="position:absolute;top:10px;right:18px;font-size:2em;cursor:pointer">&times;</span><iframe id="helpFrame" src="help.html" style="width:100%;height:100%;border:none;border-radius:12px"></iframe></div></div><div id="notification" class="notification"></div><footer class="app-footer" style="display:flex;justify-content:space-between;align-items:center"><span>&nbsp;&nbsp; üçÅ Maple - Project Management Suite </span><span style="font-size:.6em;opacity:.85;margin-right:24px">Created with <span style="color:#e25555">‚ù§Ô∏è</span> in <a href="https://en.wikipedia.org/wiki/New_Hampshire" target="_blank" style="color:#fff;text-decoration:underline">New Hampshire</a> by <a href="https://mohan-chinnappan-n.github.io/about/cv.html" target="_blank" style="color:#fff;text-decoration:underline">MC</a> &nbsp;|&nbsp; <span id="footerVersion"></span></span></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script><script>const VERSION="1.0.5";let projectData={name:"Sample Project",startDate:(new Date).toISOString().split("T")[0],endDate:new Date(Date.now()+7776e6).toISOString().split("T")[0],tasks:[],resources:[],settings:{workingDays:[1,2,3,4,5],workingHours:8}},currentEditingTask=null,currentEditingResource=null;function showTab(e){document.querySelectorAll(".tab").forEach((e=>e.classList.remove("active"))),document.querySelectorAll(".tab-content").forEach((e=>e.classList.remove("active"))),event.target.classList.add("active"),document.getElementById(e).classList.add("active"),"gantt"===e?setTimeout((()=>renderGanttChart()),100):"reports"===e?setTimeout((()=>renderReports()),100):"calendar"===e&&setTimeout((()=>renderCalendar()),100)}function openModal(e){document.getElementById(e).style.display="block","taskModal"===e&&updateTaskSelectors()}function closeModal(e){document.getElementById(e).style.display="none","taskModal"===e?(document.getElementById("taskForm").reset(),currentEditingTask=null):"resourceModal"===e&&(document.getElementById("resourceForm").reset(),currentEditingResource=null)}function openHelpModal(){document.getElementById("helpModal").style.display="block"}function closeHelpModal(){document.getElementById("helpModal").style.display="none"}function renderTasks(){const e=document.getElementById("taskGrid");e.innerHTML="",projectData.tasks.forEach((t=>{const n=document.createElement("div");n.className="task-card";const a=`status-${t.status}`,r=getPriorityColor(t.priority);n.innerHTML=`\n                    <div class="task-header">\n                        <div class="task-title" style="border-left: 4px solid ${r}; padding-left: 10px;">\n                            ${t.name}\n                        </div>\n                        <div class="task-status ${a}">${t.status.replace("-"," ")}</div>\n                    </div>\n                    <p style="color: #666; margin-bottom: 15px;">${t.description||"No description"}</p>\n                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">\n                        <span><strong>Start:</strong> ${formatDate(t.startDate)}</span>\n                        <span><strong>End:</strong> ${formatDate(t.endDate)}</span>\n                    </div>\n                    <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">\n                        <span><strong>Priority:</strong> ${t.priority}</span>\n                        <span><strong>Assignee:</strong> ${getResourceName(t.assignee)||"Unassigned"}</span>\n                    </div>\n                    <div class="progress-bar">\n                        <div class="progress-fill" style="width: ${t.progress}%"></div>\n                    </div>\n                    <div style="text-align: center; margin-bottom: 15px;">\n                        <small>${t.progress}% Complete</small>\n                    </div>\n                    <div style="display: flex; gap: 10px;">\n                        <button class="btn btn-secondary" onclick="editTask('${t.id}')" style="flex: 1; font-size: 12px;">Edit</button>\n                        <button class="btn" onclick="deleteTask('${t.id}')" style="flex: 1; font-size: 12px; background: #e17055; color: white;">Delete</button>\n                    </div>\n                `,e.appendChild(n)}))}function renderResources(){const e=document.getElementById("resourcesGrid");e.innerHTML="",projectData.resources.forEach((t=>{const n=document.createElement("div");n.className="resource-card";const a=getResourceTypeIcon(t.type);n.innerHTML=`\n                    <div style="display: flex; align-items: center; margin-bottom: 15px;">\n                        <span style="font-size: 24px; margin-right: 10px;">${a}</span>\n                        <div>\n                            <h3 style="margin: 0; color: #333;">${t.name}</h3>\n                            <p style="margin: 0; color: #666; text-transform: capitalize;">${t.type}</p>\n                        </div>\n                    </div>\n                    <div style="margin-bottom: 10px;">\n                        <strong>Rate:</strong> $${t.rate}/hour\n                    </div>\n                    <div style="margin-bottom: 15px;">\n                        <strong>Availability:</strong> ${t.availability}%\n                        <div class="progress-bar">\n                            <div class="progress-fill" style="width: ${t.availability}%; background: linear-gradient(90deg, #00b894, #00a085);"></div>\n                        </div>\n                    </div>\n                    <div style="margin-bottom: 15px;">\n                        <strong>Skills:</strong>\n                        <p style="color: #666; margin: 5px 0;">${t.skills||"No skills specified"}</p>\n                    </div>\n                    <div style="display: flex; gap: 10px;">\n                        <button class="btn btn-secondary" onclick="editResource('${t.id}')" style="flex: 1; font-size: 12px;">Edit</button>\n                        <button class="btn" onclick="deleteResource('${t.id}')" style="flex: 1; font-size: 12px; background: #e17055; color: white;">Delete</button>\n                    </div>\n                `,e.appendChild(n)}))}function parseLocalDate(e){const[t,n,a]=e.split("-").map(Number);return new Date(t,n-1,a)}function renderGanttChart(){const e=document.getElementById("ganttChart");if(!e)return;if(e.innerHTML="",!projectData.tasks||0===projectData.tasks.length)return void(e.innerHTML='<div style="padding:2em;">No tasks to display.</div>');let t=null,n=null;if(projectData.tasks.forEach((e=>{const a=parseLocalDate(e.startDate),r=parseLocalDate(e.endDate);(!t||a<t)&&(t=a),(!n||r>n)&&(n=r)})),!t||!n)return;const a=Math.ceil((n-t)/864e5)+1,r=`200px repeat(${a}, 30px)`;e.style.setProperty("--gantt-columns",r);const o=document.createElement("div");o.className="gantt-header";const s=document.createElement("div");s.textContent="Task Name",o.appendChild(s);for(let e=0;e<a;e++){const n=new Date(t);n.setDate(t.getDate()+e);const a=document.createElement("div");a.className="gantt-day",a.textContent=n.getDate(),a.title=n.toDateString(),o.appendChild(a)}e.appendChild(o),projectData.tasks.forEach((n=>{const r=document.createElement("div");r.className="gantt-row";const o=document.createElement("div");o.className="gantt-task-name",o.textContent=n.name,r.appendChild(o);const s=parseLocalDate(n.startDate),i=parseLocalDate(n.endDate),d=Math.max(0,Math.floor((s-t)/864e5)),c=Math.max(1,Math.floor((i-s)/864e5)+1);for(let e=0;e<a;e++){const t=document.createElement("div");if(t.className="gantt-day",e>=d&&e<d+c){const e=document.createElement("div");e.className="gantt-bar",e.style.background=getPriorityColor?getPriorityColor(n.priority):"#667eea",e.title=`${n.name} (${n.progress||0}% complete)`,n.progress&&n.progress>0&&(e.style.background=`linear-gradient(to right, \n                                #00b894 0%, \n                                #00b894 ${n.progress}%, \n                                #667eea ${n.progress}%, \n                                #667eea 100%)`),t.appendChild(e)}r.appendChild(t)}e.appendChild(r)}))}document.addEventListener("DOMContentLoaded",(function(){const e=localStorage.getItem("maple_last_project");document.getElementById("footerVersion").textContent="v1.0.5",e?(projectData=JSON.parse(e),document.getElementById("projectName").value=projectData.name||""):addSampleData(),renderTasks(),renderResources(),updateTaskSelectors(),renderGanttChart(),renderCalendar();const t=document.querySelector(".file-upload");t.addEventListener("dragover",(function(e){e.preventDefault(),t.style.background="rgba(102, 126, 234, 0.15)",t.style.borderColor="#764ba2"})),t.addEventListener("dragleave",(function(e){e.preventDefault(),t.style.background="",t.style.borderColor=""})),t.addEventListener("drop",(function(e){e.preventDefault(),t.style.background="",t.style.borderColor="";const n=e.dataTransfer.files[0];if(n&&n.name.endsWith(".json")){new Event("change");const t=document.getElementById("importFile");t.files=e.dataTransfer.files,importProject({target:t})}else showNotification("Please drop a valid JSON file.")}))})),window.onclick=function(e){const t=document.getElementById("helpModal");e.target===t&&(t.style.display="none")},document.getElementById("taskForm").addEventListener("submit",(function(e){e.preventDefault();const t={id:currentEditingTask?currentEditingTask.id:generateId(),name:document.getElementById("taskName").value,description:document.getElementById("taskDescription").value,startDate:document.getElementById("taskStartDate").value,endDate:document.getElementById("taskEndDate").value,duration:parseInt(document.getElementById("taskDuration").value),priority:document.getElementById("taskPriority").value,status:document.getElementById("taskStatus").value,progress:parseInt(document.getElementById("taskProgress").value),assignee:document.getElementById("taskAssignee").value,dependencies:Array.from(document.getElementById("taskDependencies").selectedOptions).map((e=>e.value)),createdDate:currentEditingTask?currentEditingTask.createdDate:(new Date).toISOString()};if(currentEditingTask){const e=projectData.tasks.findIndex((e=>e.id===currentEditingTask.id));projectData.tasks[e]=t}else projectData.tasks.push(t);renderTasks(),updateTaskSelectors(),renderGanttChart(),renderCalendar(),closeModal("taskModal"),showNotification("Task saved successfully!")})),document.getElementById("resourceForm").addEventListener("submit",(function(e){e.preventDefault();const t={id:currentEditingResource?currentEditingResource.id:generateId(),name:document.getElementById("resourceName").value,type:document.getElementById("resourceType").value,rate:parseFloat(document.getElementById("resourceRate").value),availability:parseInt(document.getElementById("resourceAvailability").value),skills:document.getElementById("resourceSkills").value,createdDate:currentEditingResource?currentEditingResource.createdDate:(new Date).toISOString()};if(currentEditingResource){const e=projectData.resources.findIndex((e=>e.id===currentEditingResource.id));projectData.resources[e]=t}else projectData.resources.push(t);renderResources(),updateTaskSelectors(),closeModal("resourceModal"),showNotification("Resource saved successfully!")}));let calendarMonth=(new Date).getMonth(),calendarYear=(new Date).getFullYear();function renderCalendar(){const e=document.getElementById("calendarView");if(!e)return;e.innerHTML="";const t=new Date,n=t.getMonth(),a=t.getFullYear();e.innerHTML=`\n                <div style="text-align: center; margin-bottom: 20px;">\n                    <h3>${t.toLocaleString("default",{month:"long",year:"numeric"})}</h3>\n                </div>\n                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">\n                    ${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>`<div style="text-align: center; font-weight: bold; padding: 10px; background: #f8f9fa; border-radius: 5px;">${e}</div>`)).join("")}\n                </div>\n                <div id="calendarDays" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-top: 10px;">\n                </div>\n            `;const r=document.getElementById("calendarDays"),o=new Date(a,n,1).getDay(),s=new Date(a,n+1,0).getDate();for(let e=0;e<o;e++){const e=document.createElement("div");e.style.height="80px",r.appendChild(e)}for(let e=1;e<=s;e++){const t=document.createElement("div");t.style.cssText="\n                    height: 80px; \n                    padding: 5px; \n                    border: 1px solid #e1e5e9; \n                    border-radius: 5px; \n                    position: relative;\n                    background: #f8f9fa;\n                ";const o=document.createElement("div");o.textContent=e,o.style.fontWeight="bold",t.appendChild(o);const s=new Date(a,n,e),i=projectData.tasks.filter((e=>{const t=parseLocalDate(e.startDate),n=parseLocalDate(e.endDate);return s>=t&&s<=n}));if(i.forEach(((e,n)=>{if(n<2){const n=document.createElement("div");n.style.cssText=`\n                            font-size: 10px; \n                            background: ${getPriorityColor(e.priority)}; \n                            color: white; \n                            padding: 2px 4px; \n                            border-radius: 3px; \n                            margin-top: 2px;\n                            cursor: pointer;\n                        `,n.textContent=e.name,n.title=e.name,n.onclick=()=>editTask(e.id),t.appendChild(n)}})),i.length>2){const e=document.createElement("div");e.style.cssText="font-size: 10px; color: #666; margin-top: 2px;",e.textContent=`+${i.length-2} more`,t.appendChild(e)}r.appendChild(t)}}function renderReports(){const e=document.getElementById("reportsContainer");if(!e)return;const t=projectData.tasks.length,n=projectData.tasks.filter((e=>"completed"===e.status)).length,a=projectData.tasks.filter((e=>"in-progress"===e.status)).length,r=projectData.tasks.filter((e=>"delayed"===e.status)).length,o=t>0?Math.round(projectData.tasks.reduce(((e,t)=>e+t.progress),0)/t):0,s=projectData.resources.reduce(((e,t)=>e+8*t.rate),0),i=Math.round(projectData.resources.reduce(((e,t)=>e+t.availability),0)/Math.max(projectData.resources.length,1));e.innerHTML=`\n                \x3c!-- Project Overview --\x3e\n                <div class="chart-container">\n                    <h3 style="margin-bottom: 20px; color: #333;">Project Overview</h3>\n                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">\n                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 10px;">\n                            <h2 style="margin: 0; font-size: 2.5em;">${t}</h2>\n                            <p style="margin: 5px 0 0 0;">Total Tasks</p>\n                        </div>\n                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #ffecd2, #fcb69f); color: #333; border-radius: 10px;">\n                            <h2 style="margin: 0; font-size: 2.5em;">${o}%</h2>\n                            <p style="margin: 5px 0 0 0;">Avg Progress</p>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Task Status Distribution --\x3e\n                <div class="chart-container">\n                    <h3 style="margin-bottom: 20px; color: #333;">Task Status Distribution</h3>\n                    <div style="display: flex; flex-direction: column; gap: 15px;">\n                        <div style="display: flex; justify-content: space-between; align-items: center;">\n                            <span>Completed (${n})</span>\n                            <div style="flex: 1; margin: 0 15px; height: 20px; background: #e1e5e9; border-radius: 10px; overflow: hidden;">\n                                <div style="width: ${t>0?n/t*100:0}%; height: 100%; background: #00b894; border-radius: 10px;"></div>\n                            </div>\n                            <span>${t>0?Math.round(n/t*100):0}%</span>\n                        </div>\n                        <div style="display: flex; justify-content: space-between; align-items: center;">\n                            <span>In Progress (${a})</span>\n                            <div style="flex: 1; margin: 0 15px; height: 20px; background: #e1e5e9; border-radius: 10px; overflow: hidden;">\n                                <div style="width: ${t>0?a/t*100:0}%; height: 100%; background: #74b9ff; border-radius: 10px;"></div>\n                            </div>\n                            <span>${t>0?Math.round(a/t*100):0}%</span>\n                        </div>\n                        <div style="display: flex; justify-content: space-between; align-items: center;">\n                            <span>Delayed (${r})</span>\n                            <div style="flex: 1; margin: 0 15px; height: 20px; background: #e1e5e9; border-radius: 10px; overflow: hidden;">\n                                <div style="width: ${t>0?r/t*100:0}%; height: 100%; background: #e17055; border-radius: 10px;"></div>\n                            </div>\n                            <span>${t>0?Math.round(r/t*100):0}%</span>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Resource Utilization --\x3e\n                <div class="chart-container">\n                    <h3 style="margin-bottom: 20px; color: #333;">Resource Management</h3>\n                    <div style="display: grid; grid-template-rows: auto auto; gap: 20px;">\n                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #a8edea, #fed6e3); color: #333; border-radius: 10px;">\n                            <h2 style="margin: 0; font-size: 2em;">${s.toLocaleString()}</h2>\n                            <p style="margin: 5px 0 0 0;">Daily Budget</p>\n                        </div>\n                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #ffecd2, #fcb69f); color: #333; border-radius: 10px;">\n                            <h2 style="margin: 0; font-size: 2em;">${i}%</h2>\n                            <p style="margin: 5px 0 0 0;">Avg Utilization</p>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Timeline Analysis --\x3e\n                <div class="chart-container">\n                    <h3 style="margin-bottom: 20px; color: #333;">Project Timeline</h3>\n                    <div style="padding: 20px; background: #f8f9fa; border-radius: 10px;">\n                        <p><strong>Project Start:</strong> ${formatDate(projectData.startDate)}</p>\n                        <p><strong>Project End:</strong> ${formatDate(projectData.endDate)}</p>\n                        <p><strong>Total Duration:</strong> ${Math.ceil((new Date(projectData.endDate)-new Date(projectData.startDate))/864e5)} days</p>\n                        <p><strong>Critical Path Tasks:</strong> ${projectData.tasks.filter((e=>"critical"===e.priority)).length}</p>\n                    </div>\n                </div>\n            `}function generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function formatDate(e){return parseLocalDate(e).toLocaleDateString()}function getPriorityColor(e){const t={low:"#74b9ff",medium:"#667eea",high:"#e17055",critical:"#d63031"};return t[e]||t.medium}function getResourceTypeIcon(e){return{human:"üë§",equipment:"‚öôÔ∏è",material:"üì¶",budget:"üí∞"}[e]||"üìã"}function getResourceName(e){const t=projectData.resources.find((t=>t.id===e));return t?t.name:""}function updateProgressLabel(e){document.getElementById("progressLabel").textContent=e+"%"}function updateAvailabilityLabel(e){document.getElementById("availabilityLabel").textContent=e+"%"}function updateTaskSelectors(){const e=document.getElementById("taskAssignee"),t=document.getElementById("taskDependencies");e.innerHTML='<option value="">Select Assignee</option>',projectData.resources.forEach((t=>{const n=document.createElement("option");n.value=t.id,n.textContent=t.name,e.appendChild(n)})),t.innerHTML="",projectData.tasks.forEach((e=>{const n=document.createElement("option");n.value=e.id,n.textContent=e.name,t.appendChild(n)}))}function editTask(e){const t=projectData.tasks.find((t=>t.id===e));t&&(currentEditingTask=t,document.getElementById("taskName").value=t.name,document.getElementById("taskDescription").value=t.description||"",document.getElementById("taskStartDate").value=t.startDate,document.getElementById("taskEndDate").value=t.endDate,document.getElementById("taskDuration").value=t.duration||"",document.getElementById("taskPriority").value=t.priority,document.getElementById("taskStatus").value=t.status,document.getElementById("taskProgress").value=t.progress,document.getElementById("taskAssignee").value=t.assignee||"",Array.from(document.getElementById("taskDependencies").options).forEach((e=>{e.selected=t.dependencies&&t.dependencies.includes(e.value)})),updateProgressLabel(t.progress),openModal("taskModal"))}function editResource(e){const t=projectData.resources.find((t=>t.id===e));t&&(currentEditingResource=t,document.getElementById("resourceName").value=t.name,document.getElementById("resourceType").value=t.type,document.getElementById("resourceRate").value=t.rate,document.getElementById("resourceAvailability").value=t.availability,document.getElementById("resourceSkills").value=t.skills||"",updateAvailabilityLabel(t.availability),openModal("resourceModal"))}function deleteTask(e){confirm("Are you sure you want to delete this task?")&&(projectData.tasks=projectData.tasks.filter((t=>t.id!==e)),renderTasks(),updateTaskSelectors(),renderGanttChart(),showNotification("Task deleted successfully!"))}function deleteResource(e){confirm("Are you sure you want to delete this resource?")&&(projectData.resources=projectData.resources.filter((t=>t.id!==e)),renderResources(),updateTaskSelectors(),showNotification("Resource deleted successfully!"))}function exportProject(){const e=JSON.stringify(projectData,null,2),t=new Blob([e],{type:"application/json"}),n=(projectData.name||"project").replace(/[^a-z0-9]/gi,"_").toLowerCase(),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=`${n}_${(new Date).toISOString().split("T")[0]}.json`,a.click(),showNotification("Project exported successfully!")}function importProject(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=function(e){try{const t=JSON.parse(e.target.result);if(!t.tasks||!t.resources)throw new Error("Invalid project file format");projectData=t,renderTasks(),renderResources(),updateTaskSelectors(),renderGanttChart(),renderCalendar(),document.getElementById("projectName").value=projectData.name,showNotification("Project imported successfully!")}catch(e){alert("Error importing project: "+e.message)}},n.readAsText(t)}function generateReport(){const e=window.open("","_blank"),t=`\n                <!DOCTYPE html>\n                <html>\n                <head>\n                    <title>Project Report</title>\n                    <link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico">\n\n                    <style>\n                        body { font-family: Arial, sans-serif; margin: 40px; }\n                        .header { text-align: center; margin-bottom: 30px; }\n                        .section { margin-bottom: 30px; }\n                        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n                        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n                        th { background-color: #f2f2f2; }\n                        .status-completed { background-color: #d4edda; }\n                        .status-in-progress { background-color: #d1ecf1; }\n                        .status-delayed { background-color: #f8d7da; }\n                        .priority-critical { background-color: #f5c6cb; }\n                        .priority-high { background-color: #fdeaa7; }\n                    </style>\n                </head>\n                <body>\n                    <div class="header">\n                        <h1>Project Management Report</h1>\n                        <p>Generated on: ${(new Date).toLocaleString()}</p>\n                    </div>\n                    \n                    <div class="section">\n                        <h2>Project Summary</h2>\n                        <p><strong>Project Name:</strong> ${projectData.name}</p>\n                        <p><strong>Start Date:</strong> ${formatDate(projectData.startDate)}</p>\n                        <p><strong>End Date:</strong> ${formatDate(projectData.endDate)}</p>\n                        <p><strong>Total Tasks:</strong> ${projectData.tasks.length}</p>\n                        <p><strong>Total Resources:</strong> ${projectData.resources.length}</p>\n                    </div>\n\n                    <div class="section">\n                        <h2>Task Details</h2>\n                        <table>\n                            <thead>\n                                <tr>\n                                    <th>Task Name</th>\n                                    <th>Status</th>\n                                    <th>Priority</th>\n                                    <th>Progress</th>\n                                    <th>Start Date</th>\n                                    <th>End Date</th>\n                                    <th>Assignee</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${projectData.tasks.map((e=>`\n                                    <tr class="status-${e.status} priority-${e.priority}">\n                                        <td>${e.name}</td>\n                                        <td>${e.status.replace("-"," ").toUpperCase()}</td>\n                                        <td>${e.priority.toUpperCase()}</td>\n                                        <td>${e.progress}%</td>\n                                        <td>${formatDate(e.startDate)}</td>\n                                        <td>${formatDate(e.endDate)}</td>\n                                        <td>${getResourceName(e.assignee)||"Unassigned"}</td>\n                                    </tr>\n                                `)).join("")}\n                            </tbody>\n                        </table>\n                    </div>\n\n                    <div class="section">\n                        <h2>Resources</h2>\n                        <table>\n                            <thead>\n                                <tr>\n                                    <th>Resource Name</th>\n                                    <th>Type</th>\n                                    <th>Rate</th>\n                                    <th>Availability</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${projectData.resources.map((e=>`\n                                    <tr>\n                                        <td>${e.name}</td>\n                                        <td>${e.type.toUpperCase()}</td>\n                                        <td>${e.rate}/hour</td>\n                                        <td>${e.availability}%</td>\n                                    </tr>\n                                `)).join("")}\n                            </tbody>\n                        </table>\n                    </div>\n                </body>\n                </html>\n            `;e.document.write(t),e.document.close(),showNotification("Report generated successfully!")}function showNotification(e){const t=document.getElementById("notification");t.textContent=e,t.classList.add("show"),setTimeout((()=>{t.classList.remove("show")}),3e3)}function addSampleData(){const e=[{id:generateId(),name:"Project Planning",description:"Initial project planning and requirement gathering",startDate:"2024-06-01",endDate:"2024-06-07",duration:7,priority:"high",status:"completed",progress:100,assignee:"",dependencies:[],createdDate:(new Date).toISOString()},{id:generateId(),name:"Design Phase",description:"Create wireframes and design mockups",startDate:"2024-06-08",endDate:"2024-06-20",duration:13,priority:"medium",status:"in-progress",progress:60,assignee:"",dependencies:[],createdDate:(new Date).toISOString()},{id:generateId(),name:"Development",description:"Frontend and backend development",startDate:"2024-06-15",endDate:"2024-07-15",duration:30,priority:"critical",status:"not-started",progress:0,assignee:"",dependencies:[],createdDate:(new Date).toISOString()},{id:generateId(),name:"Testing",description:"Quality assurance and testing",startDate:"2024-07-10",endDate:"2024-07-25",duration:15,priority:"high",status:"not-started",progress:0,assignee:"",dependencies:[],createdDate:(new Date).toISOString()}],t=[{id:generateId(),name:"John Smith",type:"human",rate:75,availability:100,skills:"Project Management, Leadership, Planning",createdDate:(new Date).toISOString()},{id:generateId(),name:"Sarah Johnson",type:"human",rate:85,availability:80,skills:"UI/UX Design, Figma, Adobe Creative Suite",createdDate:(new Date).toISOString()},{id:generateId(),name:"Development Team",type:"human",rate:95,availability:90,skills:"React, Node.js, Python, Database Design",createdDate:(new Date).toISOString()},{id:generateId(),name:"Testing Equipment",type:"equipment",rate:25,availability:100,skills:"Automated Testing, Performance Testing",createdDate:(new Date).toISOString()}];projectData.tasks=e,projectData.resources=t,projectData.tasks[0].assignee=t[0].id,projectData.tasks[1].assignee=t[1].id,projectData.tasks[2].assignee=t[2].id,projectData.tasks[3].assignee=t[3].id}function calculateDuration(){const e=document.getElementById("taskStartDate").value,t=document.getElementById("taskEndDate").value;if(e&&t){const n=new Date(e),a=new Date(t),r=Math.ceil((a-n)/864e5)+1;document.getElementById("taskDuration").value=Math.max(r,1)}}function updateProjectName(e){projectData.name=e,saveProjectToLocal()}function saveProjectToLocal(){localStorage.setItem("maple_last_project",JSON.stringify(projectData))}function printCalendarPDF(){const e=document.getElementById("calendarView");e&&html2canvas(e).then((e=>{const t=e.toDataURL("image/png"),n=new window.jspdf.jsPDF({orientation:"landscape",unit:"pt",format:"a4"}),a=n.internal.pageSize.getWidth(),r=a-40,o=e.height*r/e.width;n.setFontSize(22),n.setTextColor("#764ba2"),n.text(projectData.name||"Project Calendar",a/2,40,{align:"center"}),n.addImage(t,"PNG",20,60,r,o),n.save("project_calendar.pdf")}))}function exportSmartSheetsCSV(){const e=[["Task Name","Description","Start Date","End Date","Duration","Priority","Status","Progress","Assignee","Dependencies"]];projectData.tasks.forEach((t=>{e.push([`"${(t.name||"").replace(/"/g,'""')}"`,`"${(t.description||"").replace(/"/g,'""')}"`,t.startDate||"",t.endDate||"",t.duration||"",t.priority||"",t.status||"",t.progress||"",`"${getResourceName(t.assignee)||""}"`,`"${(t.dependencies||[]).map((e=>{const t=projectData.tasks.find((t=>t.id===e));return t?t.name:""})).filter(Boolean).join("; ")}"`])}));const t=e.map((e=>e.join(","))).join("\r\n"),n=new Blob([t],{type:"text/csv"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download=(projectData.name||"project")+"_smartsheets.csv",a.click(),showNotification("SmartSheets-compatible CSV exported!")}window.onclick=function(e){document.querySelectorAll(".modal").forEach((t=>{e.target===t&&(t.style.display="none")}))},document.getElementById("taskStartDate").addEventListener("change",calculateDuration),document.getElementById("taskEndDate").addEventListener("change",calculateDuration)</script></body></html>