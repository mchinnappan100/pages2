<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico"><title>Workflow Builder</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);height:100vh;overflow:hidden}.sticky-header{position:fixed;top:0;left:0;right:0;height:60px;background:linear-gradient(90deg,#667eea 60%,#764ba2 100%);color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;letter-spacing:2px;z-index:2001;box-shadow:0 2px 16px rgba(0,0,0,.1);user-select:none}.toolbar{position:fixed;top:60px;left:0;right:0;background:rgba(255,255,255,.95);backdrop-filter:blur(10px);padding:15px 20px;box-shadow:0 2px 20px rgba(0,0,0,.1);z-index:1000;display:flex;gap:15px;align-items:center;flex-wrap:wrap}.btn{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .3s ease;background:linear-gradient(45deg,#4caf50,#45a049);color:#fff;box-shadow:0 4px 15px rgba(76,175,80,.3)}.btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(76,175,80,.4)}.btn.delete{background:linear-gradient(45deg,#f44336,#d32f2f);box-shadow:0 4px 15px rgba(244,67,54,.3)}.btn.delete:hover{box-shadow:0 6px 20px rgba(244,67,54,.4)}.color-picker{width:40px;height:40px;border:none;border-radius:8px;cursor:pointer;box-shadow:0 4px 15px rgba(0,0,0,.2)}.workspace{position:absolute;top:125px;left:0;right:0;bottom:0;overflow:auto;background:rgba(255,255,255,.1);backdrop-filter:blur(5px)}.canvas{position:relative;width:3000px;height:2000px}.task{position:absolute;min-width:120px;min-height:80px;background:linear-gradient(45deg,#3498db,#2980b9);border:2px solid #fff;border-radius:12px;padding:15px;cursor:move;user-select:none;box-shadow:0 8px 25px rgba(0,0,0,.2);transition:all .3s ease;overflow:auto;color:#fff;font-weight:600;display:flex;align-items:center;justify-content:center;text-align:center;backdrop-filter:blur(10px)}.task .resize-handle{position:absolute;width:20px;height:20px;background:rgba(255,255,255,.8);border:2px solid #fff;border-radius:50%;cursor:nw-resize;bottom:-10px;right:-10px;z-index:10;transition:all .2s ease}.task .resize-handle:hover{background:gold;transform:scale(1.2)}.task:hover{transform:translateY(-2px);box-shadow:0 12px 35px rgba(0,0,0,.3)}.task.selected{border-color:gold;box-shadow:0 0 20px rgba(255,215,0,.5)}.task.connecting{box-shadow:0 0 20px rgba(255,0,0,.7);animation:pulse 1s infinite}@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}.connection{position:absolute;pointer-events:none;z-index:1}.connection-line{stroke-width:3;fill:none;filter:drop-shadow(2px 2px 4px rgba(0, 0, 0, .3));transition:all .3s ease}.connection-arrow{fill:inherit}.connection.selected{filter:drop-shadow(0 0 10px rgba(255, 215, 0, .8))}.task-content{width:100%;height:100%;background:0 0;border:none;color:inherit;font:inherit;text-align:center;outline:0;resize:none;display:flex;align-items:center;justify-content:center}.connection-mode{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.8);color:#fff;padding:20px;border-radius:12px;font-size:18px;font-weight:600;z-index:2000;backdrop-filter:blur(10px);box-shadow:0 10px 30px rgba(0,0,0,.5)}.grid{position:absolute;top:0;left:0;width:100%;height:100%;opacity:.1;background-image:linear-gradient(rgba(255,255,255,.3) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.3) 1px,transparent 1px);background-size:20px 20px}.info-panel{position:fixed;bottom:20px;right:20px;background:rgba(255,255,255,.9);padding:15px;border-radius:12px;box-shadow:0 8px 25px rgba(0,0,0,.2);backdrop-filter:blur(10px);font-size:14px;max-width:300px}.info-panel h3{margin-bottom:10px;color:#333}.info-panel ul{list-style:none;line-height:1.6;color:#666}.info-panel li{margin-bottom:5px}</style></head><body><div class="sticky-header">Workflow Builder</div><div class="toolbar"><button class="btn" onclick="createTask()">+ Add Task</button> <button class="btn" onclick="toggleConnectionMode()">üîó Connect Tasks</button> <button class="btn delete" onclick="deleteSelected()">üóëÔ∏è Delete</button> <label>Task Color:</label> <input type="color" class="color-picker" id="taskColor" value="#3498db"> <label>Line Color:</label> <input type="color" class="color-picker" id="lineColor" value="#e74c3c"> <button class="btn" onclick="undo()">‚Ü∂ Undo</button> <button class="btn" onclick="redo()">‚Ü∑ Redo</button> <button class="btn" onclick="downloadJSON()">üíæ Save JSON</button> <button class="btn" onclick="downloadPNG()">üì∑ Save PNG</button> <button class="btn" onclick="clearAll()">Clear All</button> <input type="file" id="fileInput" accept=".json" style="display:none" onchange="loadJSON(event)"> <button class="btn" onclick='document.getElementById("fileInput").click()'>üìÅ Load JSON</button></div><div class="workspace"><div class="grid"></div><div class="canvas" id="canvas"><svg id="connections" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none"><defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c"/></marker></defs></svg></div></div><div class="info-panel"><h3>Controls</h3><ul><li>‚Ä¢ Click "Add Task" to create new tasks</li><li>‚Ä¢ Drag tasks to move them</li><li>‚Ä¢ Resize tasks by dragging corners</li><li>‚Ä¢ Click "Connect Tasks" then click two tasks</li><li>‚Ä¢ Click tasks/lines to select and change colors</li><li>‚Ä¢ Double-click tasks to edit text</li><li>‚Ä¢ Use Delete button to remove selected items</li></ul></div><script>let tasks=[],connections=[],selectedTask=null,selectedConnection=null,isConnectionMode=!1,firstTaskForConnection=null,draggedTask=null,isDragging=!1,isResizing=!1,dragOffset={x:0,y:0},taskCounter=0,history=[],historyIndex=-1;const maxHistorySize=50;function saveState(){historyIndex<history.length-1&&(history=history.slice(0,historyIndex+1));const e={tasks:JSON.parse(JSON.stringify(tasks)),connections:JSON.parse(JSON.stringify(connections)),taskCounter:taskCounter};history.push(e),history.length>50?history.shift():historyIndex++}function undo(){historyIndex>0&&(historyIndex--,loadState(history[historyIndex]))}function redo(){historyIndex<history.length-1&&(historyIndex++,loadState(history[historyIndex]))}function loadState(e){tasks=JSON.parse(JSON.stringify(e.tasks)),connections=JSON.parse(JSON.stringify(e.connections)),taskCounter=e.taskCounter;document.getElementById("canvas").innerHTML='\n                <svg id="connections" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">\n                    <defs>\n                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">\n                            <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />\n                        </marker>\n                    </defs>\n                </svg>\n            ',tasks.forEach(renderTask),connections.forEach(renderConnection),selectedTask=null,selectedConnection=null}function createTask(){saveState(),taskCounter++;const e={id:`task-${taskCounter}`,x:400*Math.random()+100,y:300*Math.random()+150,width:120,height:80,text:`Task ${taskCounter}`,color:document.getElementById("taskColor").value};tasks.push(e),renderTask(e)}function renderTask(e){const t=document.createElement("div");t.className="task",t.id=e.id,t.style.left=`${e.x}px`,t.style.top=`${e.y}px`,t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.background=e.color,t.innerHTML=`\n                <div class="task-content" contenteditable="true">${e.text}</div>\n                <div class="resize-handle"></div>\n            `,t.addEventListener("mousedown",startDrag),t.addEventListener("click",selectTask),t.addEventListener("dblclick",editTask);t.querySelector(".resize-handle").addEventListener("mousedown",startResize);t.querySelector(".task-content").addEventListener("blur",(function(){e.text!==this.textContent&&(saveState(),e.text=this.textContent)})),document.getElementById("canvas").appendChild(t)}function startDrag(e){if(e.preventDefault(),isConnectionMode)return;if(e.target.classList.contains("resize-handle"))return;isDragging=!0,draggedTask=tasks.find((t=>t.id===e.target.closest(".task").id));const t=e.target.closest(".task").getBoundingClientRect();document.getElementById("canvas").getBoundingClientRect();dragOffset.x=e.clientX-t.left,dragOffset.y=e.clientY-t.top,document.addEventListener("mousemove",drag),document.addEventListener("mouseup",stopDrag)}function startResize(e){e.preventDefault(),e.stopPropagation(),isResizing=!0;const t=e.target.closest(".task");draggedTask=tasks.find((e=>e.id===t.id));const n=t.getBoundingClientRect();dragOffset.x=n.right,dragOffset.y=n.bottom,document.addEventListener("mousemove",resize),document.addEventListener("mouseup",stopResize)}function resize(e){if(!isResizing||!draggedTask)return;const t=document.getElementById("canvas").getBoundingClientRect(),n=Math.max(120,e.clientX-t.left-draggedTask.x),o=Math.max(80,e.clientY-t.top-draggedTask.y);draggedTask.width=n,draggedTask.height=o;const s=document.getElementById(draggedTask.id);s.style.width=`${n}px`,s.style.height=`${o}px`,updateConnections()}function stopResize(){isResizing&&saveState(),isResizing=!1,draggedTask=null,document.removeEventListener("mousemove",resize),document.removeEventListener("mouseup",stopResize)}function drag(e){if(!isDragging||!draggedTask)return;const t=document.getElementById("canvas").getBoundingClientRect(),n=e.clientX-t.left-dragOffset.x,o=e.clientY-t.top-dragOffset.y;draggedTask.x=Math.max(0,n),draggedTask.y=Math.max(0,o);const s=document.getElementById(draggedTask.id);s.style.left=`${draggedTask.x}px`,s.style.top=`${draggedTask.y}px`,updateConnections()}function stopDrag(){isDragging&&saveState(),isDragging=!1,draggedTask=null,document.removeEventListener("mousemove",drag),document.removeEventListener("mouseup",stopDrag)}function selectTask(e){e.stopPropagation();const t=e.target.closest(".task").id;isConnectionMode?handleConnectionClick(t):(document.querySelectorAll(".task.selected").forEach((e=>e.classList.remove("selected"))),document.querySelectorAll(".connection.selected").forEach((e=>e.classList.remove("selected"))),selectedTask=tasks.find((e=>e.id===t)),selectedConnection=null,document.getElementById(t).classList.add("selected"))}function handleConnectionClick(e){firstTaskForConnection?firstTaskForConnection!==e&&(createConnection(firstTaskForConnection,e),document.getElementById(firstTaskForConnection).classList.remove("connecting"),firstTaskForConnection=null,toggleConnectionMode()):(firstTaskForConnection=e,document.getElementById(e).classList.add("connecting"))}function createConnection(e,t){saveState();const n={id:`conn-${Date.now()}`,from:e,to:t,color:document.getElementById("lineColor").value};connections.push(n),renderConnection(n)}function renderConnection(e){const t=document.getElementById("connections"),n=document.createElementNS("http://www.w3.org/2000/svg","path"),o=document.createElementNS("http://www.w3.org/2000/svg","g");o.classList.add("connection"),o.id=e.id,n.classList.add("connection-line"),n.style.stroke=e.color,n.setAttribute("marker-end","url(#arrowhead)"),o.appendChild(n),o.addEventListener("click",(t=>{t.stopPropagation(),selectConnection(e.id)})),t.appendChild(o),updateConnectionPath(e)}function updateConnectionPath(e){const t=tasks.find((t=>t.id===e.from)),n=tasks.find((t=>t.id===e.to));if(!t||!n)return;const o={x:t.x+t.width/2,y:t.y+t.height/2},s=getConnectionPoint(t,{x:n.x+n.width/2,y:n.y+n.height/2}),i=getConnectionPoint(n,o),c=i.x-s.x,a=i.y-s.y,d=Math.min(100,.5*Math.abs(c),.5*Math.abs(a)),r=`M ${s.x} ${s.y} \n                         C ${s.x+d} ${s.y},\n                           ${i.x-d} ${i.y},\n                           ${i.x} ${i.y}`,l=document.querySelector(`#${e.id} path`);l&&l.setAttribute("d",r)}function getConnectionPoint(e,t){const n=e.x+e.width/2,o=e.y+e.height/2,s=t.x-n,i=t.y-o,c=Math.atan2(i,s),a=Math.cos(c),d=Math.sin(c),r=e.width/2,l=e.height/2;let u,g;return Math.abs(a)>Math.abs(d)?(u=n+(a>0?r:-r),g=o+d*r/Math.abs(a)):(u=n+a*l/Math.abs(d),g=o+(d>0?l:-l)),{x:u,y:g}}function updateConnections(){connections.forEach(updateConnectionPath)}function selectConnection(e){document.querySelectorAll(".task.selected").forEach((e=>e.classList.remove("selected"))),document.querySelectorAll(".connection.selected").forEach((e=>e.classList.remove("selected"))),selectedConnection=connections.find((t=>t.id===e)),selectedTask=null,document.getElementById(e).classList.add("selected")}function toggleConnectionMode(){isConnectionMode=!isConnectionMode,isConnectionMode?document.body.insertAdjacentHTML("beforeend",'<div class="connection-mode">Connection Mode: Click two tasks to connect them</div>'):(document.querySelector(".connection-mode")?.remove(),document.querySelectorAll(".task.connecting").forEach((e=>e.classList.remove("connecting"))),firstTaskForConnection=null)}function deleteSelected(){if((selectedTask||selectedConnection)&&saveState(),selectedTask)tasks=tasks.filter((e=>e.id!==selectedTask.id)),connections=connections.filter((e=>e.from!==selectedTask.id&&e.to!==selectedTask.id)),document.getElementById(selectedTask.id).remove(),renderAllConnections(),selectedTask=null;else if(selectedConnection){connections=connections.filter((e=>e.id!==selectedConnection.id));const e=document.getElementById(selectedConnection.id);e&&e.remove(),selectedConnection=null}}function renderAllConnections(){document.getElementById("connections").innerHTML='\n                <defs>\n                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">\n                        <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />\n                    </marker>\n                </defs>\n            ',connections.forEach(renderConnection)}function clearAll(){confirm("Are you sure you want to clear all tasks and connections?")&&(saveState(),tasks=[],connections=[],selectedTask=null,selectedConnection=null,document.getElementById("canvas").innerHTML='\n                    <svg id="connections" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">\n                        <defs>\n                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">\n                                <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />\n                            </marker>\n                        </defs>\n                    </svg>\n                ')}function editTask(e){e.stopPropagation();(e.target.querySelector(".task-content")||e.target).focus()}function downloadJSON(){const e={tasks:tasks,connections:connections,taskCounter:taskCounter,timestamp:(new Date).toISOString()},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download=`workflow-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}function loadJSON(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=function(e){try{const t=JSON.parse(e.target.result);saveState(),tasks=t.tasks||[],connections=t.connections||[],taskCounter=t.taskCounter||0;document.getElementById("canvas").innerHTML='\n                        <svg id="connections" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">\n                            <defs>\n                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">\n                                    <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />\n                                </marker>\n                            </defs>\n                        </svg>\n                    ',tasks.forEach(renderTask),connections.forEach(renderConnection),selectedTask=null,selectedConnection=null}catch(e){alert("Error loading file: Invalid JSON format")}},n.readAsText(t),e.target.value=""}function downloadPNG(){document.getElementById("canvas");const e=document.createElement("canvas"),t=e.getContext("2d");let n=1/0,o=1/0,s=-1/0,i=-1/0;tasks.forEach((e=>{n=Math.min(n,e.x),o=Math.min(o,e.y),s=Math.max(s,e.x+e.width),i=Math.max(i,e.y+e.height)}));n-=50,o-=50,s+=50,i+=50,e.width=s-n,e.height=i-o,t.fillStyle="#667eea",t.fillRect(0,0,e.width,e.height),connections.forEach((e=>{const s=tasks.find((t=>t.id===e.from)),i=tasks.find((t=>t.id===e.to));if(!s||!i)return;const c=getConnectionPoint(s,{x:i.x+i.width/2,y:i.y+i.height/2}),a=getConnectionPoint(i,{x:s.x+s.width/2,y:s.y+s.height/2});c.x-=n,c.y-=o,a.x-=n,a.y-=o,t.strokeStyle=e.color,t.lineWidth=3,t.beginPath(),t.moveTo(c.x,c.y);const d=a.x-c.x,r=a.y-c.y,l=Math.min(100,.5*Math.abs(d),.5*Math.abs(r));t.bezierCurveTo(c.x+l,c.y,a.x-l,a.y,a.x,a.y),t.stroke();const u=Math.atan2(r,d),g=Math.PI/6;t.fillStyle=e.color,t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(a.x-15*Math.cos(u-g),a.y-15*Math.sin(u-g)),t.lineTo(a.x-15*Math.cos(u+g),a.y-15*Math.sin(u+g)),t.closePath(),t.fill()})),tasks.forEach((e=>{const s=e.x-n,i=e.y-o;t.fillStyle=e.color,t.fillRect(s,i,e.width,e.height),t.strokeStyle="#fff",t.lineWidth=2,t.strokeRect(s,i,e.width,e.height),t.fillStyle="#fff",t.font="16px Segoe UI",t.textAlign="center",t.textBaseline="middle",t.fillText(e.text,s+e.width/2,i+e.height/2)})),e.toBlob((e=>{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`workflow-${(new Date).toISOString().slice(0,10)}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}))}document.getElementById("taskColor").addEventListener("change",(function(){selectedTask&&(saveState(),selectedTask.color=this.value,document.getElementById(selectedTask.id).style.background=this.value)})),document.getElementById("lineColor").addEventListener("change",(function(){if(selectedConnection){saveState(),selectedConnection.color=this.value;const e=document.querySelector(`#${selectedConnection.id} path`);e&&(e.style.stroke=this.value)}})),document.getElementById("canvas").addEventListener("click",(function(e){e.target===this&&(document.querySelectorAll(".task.selected").forEach((e=>e.classList.remove("selected"))),document.querySelectorAll(".connection.selected").forEach((e=>e.classList.remove("selected"))),selectedTask=null,selectedConnection=null)})),document.addEventListener("keydown",(function(e){"Delete"===e.key&&(selectedTask||selectedConnection)?deleteSelected():"Escape"===e.key&&isConnectionMode?toggleConnectionMode():(e.ctrlKey||e.metaKey)&&("z"!==e.key||e.shiftKey?("y"===e.key||"z"===e.key&&e.shiftKey)&&(e.preventDefault(),redo()):(e.preventDefault(),undo()))})),createTask(),createTask(),setTimeout((()=>{saveState()}),100)</script></body></html>