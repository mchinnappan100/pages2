<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Drum Machine</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .drum-pad {
      transition: all 0.1s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }
    .drum-pad:active, .drum-pad.playing {
      transform: scale(0.95);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
    }
    .drum-pad:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }
    .sequencer-cell {
      transition: all 0.2s;
      cursor: pointer;
    }
    .sequencer-cell:hover {
      transform: scale(1.1);
    }
    .sequencer-cell.active {
      background: #fbbf24;
      box-shadow: 0 0 15px #fbbf24;
    }
    .sequencer-cell.playing {
      background: #22c55e;
      box-shadow: 0 0 20px #22c55e;
      animation: pulse 0.3s ease;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }
    .volume-slider {
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255, 255, 255, 0.2);
      outline: none;
      border-radius: 15px;
      height: 8px;
    }
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: #fbbf24;
      cursor: pointer;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body class="p-6">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-6xl font-bold text-white mb-4 flex items-center justify-center gap-4">
        <i class="fas fa-drum"></i>
        Drum Machine
        <i class="fas fa-drum"></i>
      </h1>
      <p class="text-white text-xl opacity-90">Play drums with your keyboard or click the pads!</p>
    </div>

    <!-- Main Container -->
    <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl mb-6">
      
      <!-- Drum Pads Grid -->
      <div class="grid grid-cols-3 gap-6 mb-8">
        <!-- Kick Drum -->
        <div class="drum-pad bg-gradient-to-br from-red-500 to-red-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="kick" data-key="a">
          <i class="fas fa-drum text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">KICK</div>
          <div class="text-white text-sm opacity-75 mt-2">Press A</div>
        </div>

        <!-- Snare -->
        <div class="drum-pad bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="snare" data-key="s">
          <i class="fas fa-circle text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">SNARE</div>
          <div class="text-white text-sm opacity-75 mt-2">Press S</div>
        </div>

        <!-- Hi-Hat Closed -->
        <div class="drum-pad bg-gradient-to-br from-yellow-500 to-yellow-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="hihat-closed" data-key="d">
          <i class="fas fa-circle-notch text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">HI-HAT</div>
          <div class="text-white text-sm opacity-75 mt-2">Press D</div>
        </div>

        <!-- Tom 1 -->
        <div class="drum-pad bg-gradient-to-br from-purple-500 to-purple-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="tom1" data-key="q">
          <i class="fas fa-compact-disc text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">TOM 1</div>
          <div class="text-white text-sm opacity-75 mt-2">Press Q</div>
        </div>

        <!-- Tom 2 -->
        <div class="drum-pad bg-gradient-to-br from-green-500 to-green-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="tom2" data-key="w">
          <i class="fas fa-compact-disc text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">TOM 2</div>
          <div class="text-white text-sm opacity-75 mt-2">Press W</div>
        </div>

        <!-- Tom 3 -->
        <div class="drum-pad bg-gradient-to-br from-pink-500 to-pink-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="tom3" data-key="e">
          <i class="fas fa-compact-disc text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">TOM 3</div>
          <div class="text-white text-sm opacity-75 mt-2">Press E</div>
        </div>

        <!-- Crash Cymbal -->
        <div class="drum-pad bg-gradient-to-br from-orange-500 to-orange-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="crash" data-key="z">
          <i class="fas fa-star text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">CRASH</div>
          <div class="text-white text-sm opacity-75 mt-2">Press Z</div>
        </div>

        <!-- Ride Cymbal -->
        <div class="drum-pad bg-gradient-to-br from-teal-500 to-teal-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="ride" data-key="x">
          <i class="fas fa-certificate text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">RIDE</div>
          <div class="text-white text-sm opacity-75 mt-2">Press X</div>
        </div>

        <!-- Clap -->
        <div class="drum-pad bg-gradient-to-br from-indigo-500 to-indigo-700 rounded-2xl p-8 text-center cursor-pointer" data-sound="clap" data-key="c">
          <i class="fas fa-hands-clapping text-6xl text-white mb-4"></i>
          <div class="text-white text-2xl font-bold">CLAP</div>
          <div class="text-white text-sm opacity-75 mt-2">Press C</div>
        </div>
      </div>

      <!-- Controls -->
      <div class="bg-white bg-opacity-10 rounded-2xl p-6 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Volume Control -->
          <div class="text-center">
            <label class="text-white text-lg font-bold mb-3 block">
              <i class="fas fa-volume-up mr-2"></i>Volume
            </label>
            <input type="range" id="volumeSlider" min="0" max="100" value="70" class="volume-slider w-full">
            <div class="text-white text-sm mt-2" id="volumeDisplay">70%</div>
          </div>

          <!-- BPM Control -->
          <div class="text-center">
            <label class="text-white text-lg font-bold mb-3 block">
              <i class="fas fa-tachometer-alt mr-2"></i>BPM
            </label>
            <input type="range" id="bpmSlider" min="60" max="180" value="120" class="volume-slider w-full">
            <div class="text-white text-sm mt-2" id="bpmDisplay">120 BPM</div>
          </div>

          <!-- Sequencer Controls -->
          <div class="text-center flex items-center justify-center gap-4">
            <button id="playBtn" class="bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-lg">
              <i class="fas fa-play mr-2"></i>Play
            </button>
            <button id="stopBtn" class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-lg">
              <i class="fas fa-stop mr-2"></i>Stop
            </button>
            <button id="clearBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-lg">
              <i class="fas fa-trash mr-2"></i>Clear
            </button>
          </div>
        </div>
      </div>

      <!-- Sequencer -->
      <div class="bg-white bg-opacity-10 rounded-2xl p-6">
        <h3 class="text-white text-2xl font-bold mb-4 text-center">
          <i class="fas fa-grid-2 mr-2"></i>16-Step Sequencer
        </h3>
        <div id="sequencer" class="overflow-x-auto">
          <!-- Sequencer grid will be generated by JavaScript -->
        </div>
      </div>

      <!-- Preset Patterns -->
      <div class="mt-6 text-center">
        <h3 class="text-white text-xl font-bold mb-4">Quick Patterns</h3>
        <div class="flex flex-wrap gap-3 justify-center">
          <button class="preset-btn bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-bold" data-pattern="basic">
            Basic Beat
          </button>
          <button class="preset-btn bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold" data-pattern="rock">
            Rock Beat
          </button>
          <button class="preset-btn bg-pink-500 hover:bg-pink-600 text-white px-6 py-3 rounded-lg font-bold" data-pattern="disco">
            Disco Beat
          </button>
          <button class="preset-btn bg-teal-500 hover:bg-teal-600 text-white px-6 py-3 rounded-lg font-bold" data-pattern="hiphop">
            Hip Hop
          </button>
        </div>
      </div>
    </div>

    <!-- Info -->
    <div class="text-center text-white text-sm opacity-75">
      <p>Click pads or use keyboard shortcuts • Create patterns with the sequencer • Adjust tempo and volume</p>
    </div>
  </div>

  <script>
    // Drum sounds using Web Audio API
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    let masterVolume = 0.7;
    let bpm = 120;
    let isPlaying = false;
    let currentStep = 0;
    let intervalId = null;

    // Sequencer pattern (9 sounds x 16 steps)
    const sounds = ['kick', 'snare', 'hihat-closed', 'tom1', 'tom2', 'tom3', 'crash', 'ride', 'clap'];
    let pattern = {};
    sounds.forEach(sound => {
      pattern[sound] = new Array(16).fill(false);
    });

    // Synthesize drum sounds
    function playSound(type) {
      const now = audioContext.currentTime;
      const gainNode = audioContext.createGain();
      gainNode.connect(audioContext.destination);
      gainNode.gain.value = masterVolume;

      switch(type) {
        case 'kick':
          // Bass drum - low frequency punch
          const kickOsc = audioContext.createOscillator();
          kickOsc.frequency.setValueAtTime(150, now);
          kickOsc.frequency.exponentialRampToValueAtTime(0.01, now + 0.5);
          kickOsc.connect(gainNode);
          kickOsc.start(now);
          kickOsc.stop(now + 0.5);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
          break;

        case 'snare':
          // Snare - noise + tone
          const snareOsc = audioContext.createOscillator();
          const snareNoise = audioContext.createBufferSource();
          const noiseBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.2, audioContext.sampleRate);
          const noiseData = noiseBuffer.getChannelData(0);
          for (let i = 0; i < noiseData.length; i++) {
            noiseData[i] = Math.random() * 2 - 1;
          }
          snareNoise.buffer = noiseBuffer;
          
          snareOsc.frequency.value = 200;
          snareOsc.connect(gainNode);
          snareNoise.connect(gainNode);
          
          snareOsc.start(now);
          snareNoise.start(now);
          snareOsc.stop(now + 0.2);
          snareNoise.stop(now + 0.2);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
          break;

        case 'hihat-closed':
          // Hi-hat - high frequency noise burst
          const hihatNoise = audioContext.createBufferSource();
          const hihatBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.05, audioContext.sampleRate);
          const hihatData = hihatBuffer.getChannelData(0);
          for (let i = 0; i < hihatData.length; i++) {
            hihatData[i] = Math.random() * 2 - 1;
          }
          hihatNoise.buffer = hihatBuffer;
          
          const hihatFilter = audioContext.createBiquadFilter();
          hihatFilter.type = 'highpass';
          hihatFilter.frequency.value = 7000;
          
          hihatNoise.connect(hihatFilter);
          hihatFilter.connect(gainNode);
          hihatNoise.start(now);
          hihatNoise.stop(now + 0.05);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
          break;

        case 'tom1':
          createTom(250, 0.3, gainNode, now);
          break;

        case 'tom2':
          createTom(180, 0.3, gainNode, now);
          break;

        case 'tom3':
          createTom(120, 0.3, gainNode, now);
          break;

        case 'crash':
          // Crash cymbal - long noise
          const crashNoise = audioContext.createBufferSource();
          const crashBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 2, audioContext.sampleRate);
          const crashData = crashBuffer.getChannelData(0);
          for (let i = 0; i < crashData.length; i++) {
            crashData[i] = Math.random() * 2 - 1;
          }
          crashNoise.buffer = crashBuffer;
          
          const crashFilter = audioContext.createBiquadFilter();
          crashFilter.type = 'bandpass';
          crashFilter.frequency.value = 3000;
          
          crashNoise.connect(crashFilter);
          crashFilter.connect(gainNode);
          crashNoise.start(now);
          crashNoise.stop(now + 2);
          gainNode.gain.setValueAtTime(masterVolume * 0.7, now);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 2);
          break;

        case 'ride':
          // Ride cymbal - metallic sound
          const rideNoise = audioContext.createBufferSource();
          const rideBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.5, audioContext.sampleRate);
          const rideData = rideBuffer.getChannelData(0);
          for (let i = 0; i < rideData.length; i++) {
            rideData[i] = Math.random() * 2 - 1;
          }
          rideNoise.buffer = rideBuffer;
          
          const rideFilter = audioContext.createBiquadFilter();
          rideFilter.type = 'bandpass';
          rideFilter.frequency.value = 4000;
          
          rideNoise.connect(rideFilter);
          rideFilter.connect(gainNode);
          rideNoise.start(now);
          rideNoise.stop(now + 0.5);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
          break;

        case 'clap':
          // Clap - short noise burst
          const clapNoise = audioContext.createBufferSource();
          const clapBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.1, audioContext.sampleRate);
          const clapData = clapBuffer.getChannelData(0);
          for (let i = 0; i < clapData.length; i++) {
            clapData[i] = Math.random() * 2 - 1;
          }
          clapNoise.buffer = clapBuffer;
          
          const clapFilter = audioContext.createBiquadFilter();
          clapFilter.type = 'bandpass';
          clapFilter.frequency.value = 1500;
          
          clapNoise.connect(clapFilter);
          clapFilter.connect(gainNode);
          clapNoise.start(now);
          clapNoise.stop(now + 0.1);
          gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
          break;
      }
    }

    function createTom(freq, duration, gainNode, now) {
      const tomOsc = audioContext.createOscillator();
      tomOsc.frequency.setValueAtTime(freq, now);
      tomOsc.frequency.exponentialRampToValueAtTime(0.01, now + duration);
      tomOsc.connect(gainNode);
      tomOsc.start(now);
      tomOsc.stop(now + duration);
      gainNode.gain.exponentialRampToValueAtTime(0.01, now + duration);
    }

    // Visual feedback
    function animatePad(sound) {
      const pad = document.querySelector(`[data-sound="${sound}"]`);
      if (pad) {
        pad.classList.add('playing');
        setTimeout(() => pad.classList.remove('playing'), 100);
      }
    }

    // Drum pad clicks
    document.querySelectorAll('.drum-pad').forEach(pad => {
      pad.addEventListener('click', () => {
        const sound = pad.dataset.sound;
        playSound(sound);
        animatePad(sound);
      });
    });

    // Keyboard support
    const keyMap = {
      'a': 'kick', 's': 'snare', 'd': 'hihat-closed',
      'q': 'tom1', 'w': 'tom2', 'e': 'tom3',
      'z': 'crash', 'x': 'ride', 'c': 'clap'
    };

    document.addEventListener('keydown', (e) => {
      const sound = keyMap[e.key.toLowerCase()];
      if (sound) {
        playSound(sound);
        animatePad(sound);
      }
    });

    // Volume control
    document.getElementById('volumeSlider').addEventListener('input', (e) => {
      masterVolume = e.target.value / 100;
      document.getElementById('volumeDisplay').textContent = e.target.value + '%';
    });

    // BPM control
    document.getElementById('bpmSlider').addEventListener('input', (e) => {
      bpm = parseInt(e.target.value);
      document.getElementById('bpmDisplay').textContent = bpm + ' BPM';
      if (isPlaying) {
        stopSequencer();
        startSequencer();
      }
    });

    // Build sequencer grid
    function buildSequencer() {
      const container = document.getElementById('sequencer');
      let html = '<table class="w-full border-collapse">';
      
      sounds.forEach(sound => {
        html += '<tr>';
        html += `<td class="text-white font-bold p-2 text-right pr-4 whitespace-nowrap">${sound.toUpperCase()}</td>`;
        for (let i = 0; i < 16; i++) {
          const bgColor = i % 4 === 0 ? 'bg-white bg-opacity-30' : 'bg-white bg-opacity-10';
          html += `<td class="p-1"><div class="sequencer-cell ${bgColor} w-10 h-10 rounded-lg" data-sound="${sound}" data-step="${i}"></div></td>`;
        }
        html += '</tr>';
      });
      
      html += '</table>';
      container.innerHTML = html;

      // Add click handlers
      document.querySelectorAll('.sequencer-cell').forEach(cell => {
        cell.addEventListener('click', () => {
          const sound = cell.dataset.sound;
          const step = parseInt(cell.dataset.step);
          pattern[sound][step] = !pattern[sound][step];
          cell.classList.toggle('active', pattern[sound][step]);
        });
      });
    }

    // Sequencer playback
    function startSequencer() {
      isPlaying = true;
      currentStep = 0;
      const stepDuration = (60 / bpm) * 1000 / 4; // 16th notes
      
      intervalId = setInterval(() => {
        // Play sounds for current step
        sounds.forEach(sound => {
          if (pattern[sound][currentStep]) {
            playSound(sound);
            animatePad(sound);
          }
        });

        // Visual feedback
        document.querySelectorAll(`.sequencer-cell[data-step="${currentStep}"]`).forEach(cell => {
          cell.classList.add('playing');
          setTimeout(() => cell.classList.remove('playing'), stepDuration * 0.8);
        });

        currentStep = (currentStep + 1) % 16;
      }, stepDuration);
    }

    function stopSequencer() {
      isPlaying = false;
      if (intervalId) {
        clearInterval(intervalId);
        intervalId = null;
      }
      currentStep = 0;
      document.querySelectorAll('.sequencer-cell.playing').forEach(cell => {
        cell.classList.remove('playing');
      });
    }

    // Control buttons
    document.getElementById('playBtn').addEventListener('click', () => {
      if (!isPlaying) startSequencer();
    });

    document.getElementById('stopBtn').addEventListener('click', stopSequencer);

    document.getElementById('clearBtn').addEventListener('click', () => {
      sounds.forEach(sound => {
        pattern[sound] = new Array(16).fill(false);
      });
      document.querySelectorAll('.sequencer-cell').forEach(cell => {
        cell.classList.remove('active');
      });
      stopSequencer();
    });

    // Preset patterns
    const presets = {
      basic: {
        kick: [1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
        snare: [0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],
        'hihat-closed': [1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0]
      },
      rock: {
        kick: [1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
        snare: [0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],
        'hihat-closed': [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        crash: [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
      },
      disco: {
        kick: [1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
        snare: [0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],
        'hihat-closed': [1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
        clap: [0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0]
      },
      hiphop: {
        kick: [1,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0],
        snare: [0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0],
        'hihat-closed': [1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],
        clap: [0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0]
      }
    };

    document.querySelectorAll('.preset-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const presetName = btn.dataset.pattern;
        const preset = presets[presetName];
        
        // Clear current pattern
        sounds.forEach(sound => {
          pattern[sound] = new Array(16).fill(false);
        });

        // Load preset
        Object.keys(preset).forEach(sound => {
          pattern[sound] = preset[sound].map(v => v === 1);
        });

        // Update UI
        document.querySelectorAll('.sequencer-cell').forEach(cell => {
          const sound = cell.dataset.sound;
          const step = parseInt(cell.dataset.step);
          cell.classList.toggle('active', pattern[sound][step]);
        });
      });
    });

    // Initialize
    buildSequencer();
  </script>
</body>
</html>