<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
     <link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        /* Dark theme variables */
        body.dark-theme {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        .container {
            display: flex;
            height: 100vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .dark-theme .container {
            background: rgba(26, 32, 46, 0.95);
        }

        .left-pane {
            width: 300px;
            background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
            border-right: 2px solid #dee2e6;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .dark-theme .left-pane {
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            border-right: 2px solid #3d4852;
        }

        .right-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            transition: all 0.3s ease;
        }

        .dark-theme .right-pane {
            background: #1e1e1e;
        }

        .header {
            padding: 20px;
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .drop-zone {
            flex: 1;
            margin: 20px;
            border: 3px dashed #6c757d;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #ffffff, #f1f3f4);
            box-shadow: inset 5px 5px 10px #d1d9e6, inset -5px -5px 10px #ffffff;
        }

        .dark-theme .drop-zone {
            border-color: #4a5568;
            background: linear-gradient(145deg, #2d3748, #1a202c);
            box-shadow: inset 5px 5px 10px #1a1a2e, inset -5px -5px 10px #3d4852;
        }

        .drop-zone:hover {
            border-color: #4a90e2;
            background: linear-gradient(145deg, #f8f9ff, #e8f4fd);
            transform: translateY(-2px);
            box-shadow: inset 5px 5px 15px #d1d9e6, inset -5px -5px 15px #ffffff, 0 5px 15px rgba(74, 144, 226, 0.2);
        }

        .drop-zone.drag-over {
            border-color: #28a745;
            background: linear-gradient(145deg, #f8fff9, #e8f5e8);
            transform: scale(1.02);
        }

        .drop-icon {
            font-size: 3rem;
            color: #6c757d;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .drop-zone:hover .drop-icon {
            color: #4a90e2;
            transform: scale(1.1);
        }

        .drop-text {
            color: #495057;
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }

        .dark-theme .drop-text {
            color: #e2e8f0;
        }

        .drop-subtext {
            color: #6c757d;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .dark-theme .drop-subtext {
            color: #a0aec0;
        }

        .file-input {
            display: none;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            padding: 0 20px;
            transition: all 0.3s ease;
        }

        .dark-theme .tabs {
            background: #2d3748;
            border-bottom: 2px solid #4a5568;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: 500;
            color: #6c757d;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            transition: all 0.3s ease;
            position: relative;
        }

        .dark-theme .tab {
            color: #a0aec0;
        }

        .tab:hover {
            background: rgba(74, 144, 226, 0.1);
            color: #4a90e2;
        }

        .tab.active {
            background: white;
            color: #4a90e2;
            border-bottom: 3px solid #4a90e2;
        }

        .dark-theme .tab.active {
            background: #1e1e1e;
            color: #63b3ed;
            border-bottom: 3px solid #63b3ed;
        }

        .tab-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .tab-pane {
            display: none;
            height: 100%;
            position: relative;
        }

        .tab-pane.active {
            display: block;
        }

        #editor {
            height: 100%;
            width: 100%;
        }

        .preview {
            height: 100%;
            padding: 30px;
            overflow-y: auto;
            background: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .dark-theme .preview {
            background: #1e1e1e;
            color: #e2e8f0;
        }

        .preview h1, .preview h2, .preview h3, .preview h4, .preview h5, .preview h6 {
            color: #2c3e50;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            transition: color 0.3s ease;
        }

        .dark-theme .preview h1, 
        .dark-theme .preview h2, 
        .dark-theme .preview h3, 
        .dark-theme .preview h4, 
        .dark-theme .preview h5, 
        .dark-theme .preview h6 {
            color: #63b3ed;
        }

        .preview h1 {
            border-bottom: 2px solid #4a90e2;
            padding-bottom: 10px;
        }

        .preview p {
            margin-bottom: 1em;
            color: #34495e;
            transition: color 0.3s ease;
        }

        .dark-theme .preview p {
            color: #cbd5e0;
        }

        .preview pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            border-left: 4px solid #4a90e2;
            transition: all 0.3s ease;
        }

        .dark-theme .preview pre {
            background: #2d3748;
            border-left: 4px solid #63b3ed;
            color: #e2e8f0;
        }

        .preview code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
            transition: all 0.3s ease;
        }

        .dark-theme .preview code {
            background: #2d3748;
            color: #e2e8f0;
        }

        .preview blockquote {
            border-left: 4px solid #4a90e2;
            margin: 1em 0;
            padding: 0.5em 1em;
            background: #f8f9ff;
            color: #555;
            transition: all 0.3s ease;
        }

        .dark-theme .preview blockquote {
            border-left: 4px solid #63b3ed;
            background: #2a2d3a;
            color: #a0aec0;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: linear-gradient(90deg, #f8f9fa, #e9ecef);
            border-bottom: 1px solid #dee2e6;
            transition: all 0.3s ease;
        }

        .dark-theme .toolbar {
            background: linear-gradient(90deg, #2d3748, #4a5568);
            border-bottom: 1px solid #4a5568;
        }

        .file-info {
            color: #6c757d;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .dark-theme .file-info {
            color: #a0aec0;
        }

        .actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            box-shadow: 0 2px 8px rgba(74, 144, 226, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            box-shadow: 0 2px 8px rgba(108, 117, 125, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.4);
        }

        .btn-theme {
            background: linear-gradient(135deg, #6f42c1, #5a32a3);
            color: white;
            box-shadow: 0 2px 8px rgba(111, 66, 193, 0.3);
        }

        .btn-theme:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(111, 66, 193, 0.4);
        }

        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            text-align: center;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4a90e2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .current-file {
            margin: 20px;
            padding: 15px;
            background: rgba(74, 144, 226, 0.1);
            border-radius: 10px;
            border-left: 4px solid #4a90e2;
            transition: all 0.3s ease;
        }

        .dark-theme .current-file {
            background: rgba(99, 179, 237, 0.15);
            border-left: 4px solid #63b3ed;
        }

        .current-file h3 {
            color: #4a90e2;
            font-size: 1rem;
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .dark-theme .current-file h3 {
            color: #63b3ed;
        }

        .current-file p {
            color: #6c757d;
            font-size: 0.8rem;
            word-break: break-all;
            transition: color 0.3s ease;
        }

        .dark-theme .current-file p {
            color: #a0aec0;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .left-pane {
                width: 100%;
                height: 200px;
            }
            
            .drop-zone {
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-pane">
            <div class="header">
                <h1>📝 Markdown Editor</h1>
                <p>Drag & drop your .md files</p>
            </div>
            
            <div class="drop-zone" id="dropZone">
                <div class="drop-icon">📁</div>
                <div class="drop-text">Drop your markdown file here</div>
                <div class="drop-subtext">or click to browse</div>
                <input type="file" class="file-input" id="fileInput" accept=".md,.markdown,.txt">
            </div>
            
            <div class="current-file" id="currentFile" style="display: none;">
                <h3>Current File</h3>
                <p id="fileName"></p>
            </div>
        </div>
        
        <div class="right-pane">
            <div class="toolbar">
                <div class="file-info" id="fileInfo">No file loaded</div>
                <div class="actions">
                    <button class="btn btn-theme" id="themeBtn">🌙 Dark</button>
                    <button class="btn btn-secondary" id="clearBtn">🗑️ Clear</button>
                    <button class="btn btn-primary" id="exportBtn">📄 Export PDF</button>
                </div>
            </div>
            
            <div class="tabs">
                <button class="tab active" data-tab="editor">📝 Editor</button>
                <button class="tab" data-tab="preview">👁️ Preview</button>
            </div>
            
            <div class="tab-content">
                <div class="tab-pane active" id="editor-pane">
                    <div id="editor"></div>
                </div>
                <div class="tab-pane" id="preview-pane">
                    <div class="preview" id="preview">
                        <div style="text-align: center; color: #6c757d; margin-top: 100px;">
                            <h2>📋 Preview Area</h2>
                            <p>Load a markdown file to see the preview here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div>Generating PDF...</div>
    </div>

    <script>
        let editor;
        let currentFileName = '';
        
        // Initialize Monaco Editor
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            const theme = localStorage.getItem('theme') || 'light';
            if (theme === 'dark') {
                document.body.classList.add('dark-theme');
                document.getElementById('themeBtn').innerHTML = '☀️ Light';
            }
            
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: '# Welcome to Markdown Editor\n\nStart editing your markdown here...\n\n## Features\n\n- 📝 Monaco editor with syntax highlighting\n- 👁️ Live preview\n- 📄 PDF export\n- 🎨 Modern, beautiful interface\n- 🌙 Dark/Light theme support\n\n```javascript\nconst hello = "Hello, World!";\nconsole.log(hello);\n```\n\n> This is a blockquote example\n\n**Bold text** and *italic text* examples.',
                language: 'markdown',
                theme: theme === 'dark' ? 'vs-dark' : 'vs',
                automaticLayout: true,
                wordWrap: 'on',
                minimap: { enabled: true },
                fontSize: 14,
                lineHeight: 20,
                padding: { top: 20, bottom: 20 },
                scrollBeyondLastLine: false,
                smoothScrolling: true
            });
            
            // Update preview on content change
            editor.onDidChangeModelContent(() => {
                updatePreview();
            });
            
            // Initial preview update
            updatePreview();
        });
        
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;
                
                // Update tab buttons
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update tab panes
                document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
                document.getElementById(tabName + '-pane').classList.add('active');
                
                // Layout editor if switching to editor tab
                if (tabName === 'editor' && editor) {
                    setTimeout(() => editor.layout(), 100);
                }
            });
        });
        
        // Drag and drop functionality
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        
        dropZone.addEventListener('click', () => fileInput.click());
        
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });
        
        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });
        
        function handleFile(file) {
            if (!file.name.match(/\.(md|markdown|txt)$/i)) {
                alert('Please select a markdown file (.md, .markdown, or .txt)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                if (editor) {
                    editor.setValue(e.target.result);
                }
                currentFileName = file.name;
                updateFileInfo(file);
                updatePreview();
            };
            reader.readAsText(file);
        }
        
        function updateFileInfo(file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const currentFile = document.getElementById('currentFile');
            
            fileInfo.textContent = `${file.name} (${(file.size / 1024).toFixed(1)} KB)`;
            fileName.textContent = file.name;
            currentFile.style.display = 'block';
        }
        
        function updatePreview() {
            if (!editor) return;
            
            const markdown = editor.getValue();
            const html = marked.parse(markdown);
            document.getElementById('preview').innerHTML = html;
        }
        
        // Clear button
        document.getElementById('clearBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to clear the editor?')) {
                if (editor) {
                    editor.setValue('');
                }
                document.getElementById('fileInfo').textContent = 'No file loaded';
                document.getElementById('currentFile').style.display = 'none';
                currentFileName = '';
                updatePreview();
            }
        });
        
        // Theme toggle button
        document.getElementById('themeBtn').addEventListener('click', () => {
            const body = document.body;
            const themeBtn = document.getElementById('themeBtn');
            const isDark = body.classList.contains('dark-theme');
            
            if (isDark) {
                body.classList.remove('dark-theme');
                themeBtn.innerHTML = '🌙 Dark';
                if (editor) {
                    monaco.editor.setTheme('vs');
                }
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.add('dark-theme');
                themeBtn.innerHTML = '☀️ Light';
                if (editor) {
                    monaco.editor.setTheme('vs-dark');
                }
                localStorage.setItem('theme', 'dark');
            }
        });
        
        // Export PDF functionality
        document.getElementById('exportBtn').addEventListener('click', () => {
            const loading = document.getElementById('loading');
            const preview = document.getElementById('preview');
            
            if (!preview.innerHTML.trim() || preview.innerHTML.includes('Preview Area')) {
                alert('Please load a markdown file first');
                return;
            }
            
            loading.style.display = 'block';
            
            const opt = {
                margin: 1,
                filename: currentFileName ? currentFileName.replace(/\.(md|markdown|txt)$/i, '.pdf') : 'markdown-export.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'in', 
                    format: 'letter', 
                    orientation: 'portrait' 
                }
            };
            
            // Create a clean copy for PDF export
            const exportContent = preview.cloneNode(true);
            exportContent.style.fontFamily = 'Arial, sans-serif';
            exportContent.style.lineHeight = '1.6';
            exportContent.style.color = '#333';
            exportContent.style.maxWidth = '100%';
            exportContent.style.padding = '20px';
            
            html2pdf().set(opt).from(exportContent).save().then(() => {
                loading.style.display = 'none';
            }).catch(err => {
                console.error('PDF export error:', err);
                loading.style.display = 'none';
                alert('Failed to export PDF. Please try again.');
            });
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 'e':
                        e.preventDefault();
                        document.querySelector('[data-tab="editor"]').click();
                        break;
                    case 'p':
                        e.preventDefault();
                        document.querySelector('[data-tab="preview"]').click();
                        break;
                    case 's':
                        e.preventDefault();
                        document.getElementById('exportBtn').click();
                        break;
                    case 'd':
                        e.preventDefault();
                        document.getElementById('themeBtn').click();
                        break;
                }
            }
        });
    </script>
</body>
</html>
