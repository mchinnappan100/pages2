<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostgreSQL AES-256 Encryption: A Comprehensive White Paper</title>
    <link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .code-block {
            background: #1a1f2e;
            border-left: 4px solid #667eea;
        }
        /* Prism.js customization for dark theme */
        pre[class*="language-"] {
            background: #1a1f2e !important;
            margin: 0 !important;
            border-radius: 0.5rem;
        }
        code[class*="language-"] {
            background: transparent !important;
            text-shadow: none !important;
            font-size: 0.875rem;
        }
        .line-numbers .line-numbers-rows {
            border-right-color: #667eea !important;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    <!-- Header -->
    <header class="bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700">
        <div class="max-w-6xl mx-auto px-6 py-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-4xl font-bold gradient-text mb-2">PostgreSQL Database Encryption</h1>
                    <p class="text-xl text-gray-400">AES-256 Implementation Strategies and Tier-Level Security</p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-500">Technical White Paper</p>
                    <p class="text-sm text-gray-500">Version 1.0 | 2026</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-6 py-12">
        
        <!-- Executive Summary -->
        <section class="mb-16">
            <div class="bg-gradient-to-br from-purple-900/30 to-blue-900/30 rounded-lg p-8 border border-purple-800/50">
                <h2 class="text-3xl font-bold text-purple-400 mb-4">Executive Summary</h2>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Data security remains a critical concern for organizations managing sensitive information in PostgreSQL databases. 
                    This white paper explores comprehensive encryption strategies using Advanced Encryption Standard (AES) with 256-bit 
                    keys, examining implementation approaches across multiple database tiers.
                </p>
                <p class="text-gray-300 leading-relaxed">
                    We analyze encryption at rest, in transit, and at the application level, providing technical guidance for implementing 
                    defense-in-depth security architectures that protect data throughout its lifecycle.
                </p>
            </div>
        </section>

        <!-- Table of Contents -->
        <section class="mb-16">
            <div class="bg-gray-800 rounded-lg p-8 border border-gray-700">
                <h2 class="text-2xl font-bold text-blue-400 mb-6">Table of Contents</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <a href="#section1" class="block text-gray-300 hover:text-blue-400 transition">1. Introduction to AES-256</a>
                        <a href="#section2" class="block text-gray-300 hover:text-blue-400 transition">2. Encryption Tier Overview</a>
                        <a href="#section3" class="block text-gray-300 hover:text-blue-400 transition">3. Transparent Data Encryption (TDE)</a>
                        <a href="#section4" class="block text-gray-300 hover:text-blue-400 transition">4. File System Level Encryption</a>
                    </div>
                    <div class="space-y-2">
                        <a href="#section5" class="block text-gray-300 hover:text-blue-400 transition">5. Application-Level Encryption</a>
                        <a href="#section6" class="block text-gray-300 hover:text-blue-400 transition">6. Network/Transit Encryption</a>
                        <a href="#section7" class="block text-gray-300 hover:text-blue-400 transition">7. Column-Level Encryption</a>
                        <a href="#section8" class="block text-gray-300 hover:text-blue-400 transition">8. Recommendations</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 1 -->
        <section id="section1" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">1. Introduction to AES-256 Encryption</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">1.1 Understanding AES-256</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Advanced Encryption Standard (AES) with 256-bit keys represents one of the most secure symmetric encryption 
                    algorithms available. Adopted by the U.S. government for protecting classified information, AES-256 provides:
                </p>
                <div class="bg-gray-900 rounded p-4 space-y-2">
                    <div class="flex items-start">
                        <span class="text-green-400 mr-3">â€¢</span>
                        <span class="text-gray-300">2<sup>256</sup> possible key combinations (approximately 1.1 Ã— 10<sup>77</sup>)</span>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-400 mr-3">â€¢</span>
                        <span class="text-gray-300">Resistance to brute-force attacks with current and projected computing power</span>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-400 mr-3">â€¢</span>
                        <span class="text-gray-300">FIPS 140-2 compliance for government and regulated industries</span>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-400 mr-3">â€¢</span>
                        <span class="text-gray-300">Efficient performance on modern hardware with AES-NI instruction support</span>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">1.2 Why PostgreSQL Needs Encryption</h3>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-gray-900 rounded p-4">
                        <div class="text-yellow-400 text-2xl mb-2">ğŸ”’</div>
                        <h4 class="font-semibold text-gray-200 mb-2">Compliance</h4>
                        <p class="text-sm text-gray-400">GDPR, HIPAA, PCI-DSS, and SOX regulations mandate data encryption</p>
                    </div>
                    <div class="bg-gray-900 rounded p-4">
                        <div class="text-red-400 text-2xl mb-2">ğŸ›¡ï¸</div>
                        <h4 class="font-semibold text-gray-200 mb-2">Threat Protection</h4>
                        <p class="text-sm text-gray-400">Protection against physical theft, unauthorized access, and data breaches</p>
                    </div>
                    <div class="bg-gray-900 rounded p-4">
                        <div class="text-blue-400 text-2xl mb-2">ğŸ”</div>
                        <h4 class="font-semibold text-gray-200 mb-2">Data Lifecycle</h4>
                        <p class="text-sm text-gray-400">Secure data at rest, in transit, and during backup operations</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2 -->
        <section id="section2" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">2. Encryption Tier Architecture</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">2.1 Multi-Tier Security Model</h3>
                <p class="text-gray-300 leading-relaxed mb-6">
                    PostgreSQL encryption can be implemented across multiple tiers, each offering distinct advantages and trade-offs. 
                    A defense-in-depth strategy employs encryption at multiple layers.
                </p>
                
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-900 border-b border-gray-700">
                            <tr>
                                <th class="text-left p-4 text-blue-300 font-semibold">Tier Level</th>
                                <th class="text-left p-4 text-blue-300 font-semibold">Scope</th>
                                <th class="text-left p-4 text-blue-300 font-semibold">Performance Impact</th>
                                <th class="text-left p-4 text-blue-300 font-semibold">Granularity</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700">
                            <tr class="hover:bg-gray-750">
                                <td class="p-4 text-gray-300 font-medium">Storage/Disk</td>
                                <td class="p-4 text-gray-400">Entire disk/partition</td>
                                <td class="p-4"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">Low (1-3%)</span></td>
                                <td class="p-4 text-gray-400">Coarse</td>
                            </tr>
                            <tr class="hover:bg-gray-750">
                                <td class="p-4 text-gray-300 font-medium">File System</td>
                                <td class="p-4 text-gray-400">Data directory/files</td>
                                <td class="p-4"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">Low (2-5%)</span></td>
                                <td class="p-4 text-gray-400">Medium</td>
                            </tr>
                            <tr class="hover:bg-gray-750">
                                <td class="p-4 text-gray-300 font-medium">Database (TDE)</td>
                                <td class="p-4 text-gray-400">Database files</td>
                                <td class="p-4"><span class="px-2 py-1 bg-yellow-900 text-yellow-300 rounded text-xs">Medium (5-15%)</span></td>
                                <td class="p-4 text-gray-400">Medium</td>
                            </tr>
                            <tr class="hover:bg-gray-750">
                                <td class="p-4 text-gray-300 font-medium">Column/Field</td>
                                <td class="p-4 text-gray-400">Specific columns</td>
                                <td class="p-4"><span class="px-2 py-1 bg-orange-900 text-orange-300 rounded text-xs">High (15-40%)</span></td>
                                <td class="p-4 text-gray-400">Fine</td>
                            </tr>
                            <tr class="hover:bg-gray-750">
                                <td class="p-4 text-gray-300 font-medium">Application</td>
                                <td class="p-4 text-gray-400">Selected data fields</td>
                                <td class="p-4"><span class="px-2 py-1 bg-red-900 text-red-300 rounded text-xs">Variable</span></td>
                                <td class="p-4 text-gray-400">Very Fine</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Section 3 -->
        <section id="section3" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">3. Transparent Data Encryption (TDE)</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">3.1 Overview</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Transparent Data Encryption encrypts database files at the PostgreSQL engine level, providing automatic encryption 
                    and decryption without application code changes. As of 2026, TDE implementations for PostgreSQL include proprietary 
                    solutions from enterprise vendors.
                </p>
                
                <div class="bg-blue-900/20 border border-blue-700/50 rounded p-4 mb-4">
                    <div class="flex items-start">
                        <span class="text-blue-400 text-xl mr-3">â„¹ï¸</span>
                        <div>
                            <p class="text-blue-300 font-semibold mb-1">Note</p>
                            <p class="text-gray-300 text-sm">PostgreSQL community edition does not include native TDE. Enterprise solutions 
                            like EDB Postgres Advanced Server and Cybertec's postgresql-TDE extension provide TDE capabilities.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">3.2 TDE Architecture</h3>
                <div class="code-block rounded p-4 mb-4">
                    <pre class="line-numbers"><code class="language-markup">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Application Layer                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      PostgreSQL Engine (Unencrypted)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          TDE Encryption Layer               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚  Master Encryption Key (MEK)    â”‚       â”‚
â”‚   â”‚  â†“                              â”‚       â”‚
â”‚   â”‚  Database Encryption Keys (DEK) â”‚       â”‚
â”‚   â”‚  â†“                              â”‚       â”‚
â”‚   â”‚  AES-256 Encryption Engine      â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Encrypted Data Files on Disk             â”‚
â”‚  â€¢ Table data files (base/...)              â”‚
â”‚  â€¢ WAL files (pg_wal/...)                   â”‚
â”‚  â€¢ Temporary files                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">3.3 Implementation Example (EDB Postgres)</h3>
                <p class="text-gray-300 mb-4">Configuration for EDB Postgres Advanced Server with TDE:</p>
                
                <div class="code-block rounded p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2">postgresql.conf</div>
                    <pre class="line-numbers"><code class="language-properties"># Enable TDE
data_encryption_key_unwrap_command = '/usr/bin/unwrap_key %p'
data_encryption_keysetup_command = '/usr/bin/setup_key %R'

# AES-256-XTS mode for TDE
wal_encryption = on
temp_file_encryption = on

# Key rotation settings
data_encryption_key_rotation_period = 90  # days</code></pre>
                </div>

                <p class="text-gray-300 mb-4">Initialization with encryption:</p>
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">bash</div>
                    <pre class="line-numbers"><code class="language-bash"># Initialize encrypted cluster
initdb -D /var/lib/postgresql/data \
       --data-encryption=AES256 \
       --wal-encryption \
       --encryption-key-command='/usr/bin/get_encryption_key'

# Verify encryption status
psql -c "SELECT name, setting FROM pg_settings 
         WHERE name LIKE '%encryption%';"</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">3.4 Advantages and Limitations</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="text-green-400 font-semibold mb-3 flex items-center">
                            <span class="mr-2">âœ“</span> Advantages
                        </h4>
                        <ul class="space-y-2 text-sm text-gray-300">
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2">â€¢</span>
                                <span>No application code changes required</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2">â€¢</span>
                                <span>Encrypts all data files, WAL, and temp files</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2">â€¢</span>
                                <span>Minimal performance overhead (5-15%)</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2">â€¢</span>
                                <span>Protects backups automatically</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2">â€¢</span>
                                <span>Centralized key management</span>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-red-400 font-semibold mb-3 flex items-center">
                            <span class="mr-2">âœ—</span> Limitations
                        </h4>
                        <ul class="space-y-2 text-sm text-gray-300">
                            <li class="flex items-start">
                                <span class="text-red-400 mr-2">â€¢</span>
                                <span>Not available in PostgreSQL community edition</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-red-400 mr-2">â€¢</span>
                                <span>Requires enterprise licensing or extensions</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-red-400 mr-2">â€¢</span>
                                <span>Data unencrypted in memory and during processing</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-red-400 mr-2">â€¢</span>
                                <span>Cannot selectively encrypt specific tables/columns</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-red-400 mr-2">â€¢</span>
                                <span>Key management complexity</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4 -->
        <section id="section4" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">4. File System Level Encryption</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">4.1 LUKS (Linux Unified Key Setup)</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    LUKS provides full disk encryption at the block device level, encrypting the entire partition containing 
                    PostgreSQL data with AES-256.
                </p>
                
                <div class="code-block rounded p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2">bash - LUKS Setup</div>
                    <pre class="line-numbers"><code class="language-bash"># Format partition with LUKS using AES-256
cryptsetup luksFormat /dev/sdb1 \
    --type luks2 \
    --cipher aes-xts-plain64 \
    --key-size 256 \
    --hash sha256 \
    --iter-time 5000

# Open encrypted device
cryptsetup luksOpen /dev/sdb1 pgdata_encrypted

# Create filesystem
mkfs.ext4 /dev/mapper/pgdata_encrypted

# Mount encrypted volume
mount /dev/mapper/pgdata_encrypted /var/lib/postgresql

# Configure automatic unlock (using key file)
dd if=/dev/urandom of=/root/pgdata.key bs=512 count=1
chmod 600 /root/pgdata.key
cryptsetup luksAddKey /dev/sdb1 /root/pgdata.key

# Add to /etc/crypttab for boot
echo "pgdata_encrypted /dev/sdb1 /root/pgdata.key luks" >> /etc/crypttab

# Add to /etc/fstab
echo "/dev/mapper/pgdata_encrypted /var/lib/postgresql ext4 defaults 0 2" >> /etc/fstab</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">4.2 EncFS / eCryptfs</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    File-based encryption solutions that encrypt individual files rather than entire partitions.
                </p>
                
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">bash - eCryptfs Setup</div>
                    <pre class="line-numbers"><code class="language-bash"># Install eCryptfs
apt-get install ecryptfs-utils

# Create encrypted directory
mkdir -p /encrypted/pgdata
mkdir -p /var/lib/postgresql/data

# Mount encrypted filesystem with AES-256
mount -t ecryptfs /encrypted/pgdata /var/lib/postgresql/data \
    -o key=passphrase,ecryptfs_cipher=aes,ecryptfs_key_bytes=32,\
    ecryptfs_passthrough=no,ecryptfs_enable_filename_crypto=yes

# Make permanent in /etc/fstab
echo "/encrypted/pgdata /var/lib/postgresql/data ecryptfs \
    key=passphrase,ecryptfs_cipher=aes,ecryptfs_key_bytes=32,\
    ecryptfs_passthrough=no,ecryptfs_enable_filename_crypto=yes 0 0" \
    >> /etc/fstab</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">4.3 ZFS Native Encryption</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    ZFS provides native AES-256 encryption at the dataset level with excellent performance.
                </p>
                
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">bash - ZFS Encryption</div>
                    <pre class="line-numbers"><code class="language-bash"># Create encrypted ZFS dataset
zfs create -o encryption=aes-256-gcm \
           -o keylocation=prompt \
           -o keyformat=passphrase \
           tank/pgdata

# Mount point becomes /tank/pgdata
# Set PostgreSQL data directory
echo "data_directory = '/tank/pgdata'" >> /etc/postgresql/15/main/postgresql.conf

# Load encryption key at boot
zfs load-key tank/pgdata

# Check encryption status
zfs get encryption,keystatus,keyformat tank/pgdata

# Backup with encryption
zfs send -w tank/pgdata@snapshot1 | gzip > encrypted_backup.zfs.gz</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">4.4 Comparison Matrix</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-900 border-b border-gray-700">
                            <tr>
                                <th class="text-left p-3 text-blue-300">Solution</th>
                                <th class="text-left p-3 text-blue-300">Granularity</th>
                                <th class="text-left p-3 text-blue-300">Performance</th>
                                <th class="text-left p-3 text-blue-300">Key Management</th>
                                <th class="text-left p-3 text-blue-300">Use Case</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700 text-gray-300">
                            <tr>
                                <td class="p-3 font-medium">LUKS</td>
                                <td class="p-3">Block device</td>
                                <td class="p-3 text-green-400">Excellent</td>
                                <td class="p-3">Simple</td>
                                <td class="p-3">Full disk encryption</td>
                            </tr>
                            <tr>
                                <td class="p-3 font-medium">eCryptfs</td>
                                <td class="p-3">File level</td>
                                <td class="p-3 text-yellow-400">Good</td>
                                <td class="p-3">Moderate</td>
                                <td class="p-3">Selective directories</td>
                            </tr>
                            <tr>
                                <td class="p-3 font-medium">ZFS</td>
                                <td class="p-3">Dataset</td>
                                <td class="p-3 text-green-400">Excellent</td>
                                <td class="p-3">Advanced</td>
                                <td class="p-3">Enterprise storage</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Section 5 -->
        <section id="section5" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">5. Application-Level Encryption</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">5.1 Overview</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Application-level encryption provides the finest granularity and control, encrypting specific sensitive data 
                    fields before storage. This approach ensures data remains encrypted throughout its lifecycle, even in memory 
                    and logs.
                </p>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">5.2 Python Implementation Example</h3>
                
                <div class="code-block rounded p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2">Python - Using cryptography library</div>
                    <pre class="line-numbers"><code class="language-python">from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives import padding
import os
import base64

class AES256Encryption:
    def __init__(self, key: bytes):
        """Initialize with 256-bit (32 bytes) key"""
        if len(key) != 32:
            raise ValueError("Key must be 32 bytes for AES-256")
        self.key = key
        self.backend = default_backend()
    
    def encrypt(self, plaintext: str) -> str:
        """Encrypt plaintext using AES-256-CBC"""
        # Generate random IV
        iv = os.urandom(16)
        
        # Pad plaintext to block size
        padder = padding.PKCS7(128).padder()
        padded_data = padder.update(plaintext.encode()) + padder.finalize()
        
        # Encrypt
        cipher = Cipher(
            algorithms.AES(self.key),
            modes.CBC(iv),
            backend=self.backend
        )
        encryptor = cipher.encryptor()
        ciphertext = encryptor.update(padded_data) + encryptor.finalize()
        
        # Return IV + ciphertext as base64
        return base64.b64encode(iv + ciphertext).decode('utf-8')
    
    def decrypt(self, encrypted_data: str) -> str:
        """Decrypt AES-256-CBC encrypted data"""
        # Decode base64
        data = base64.b64decode(encrypted_data)
        
        # Extract IV and ciphertext
        iv = data[:16]
        ciphertext = data[16:]
        
        # Decrypt
        cipher = Cipher(
            algorithms.AES(self.key),
            modes.CBC(iv),
            backend=self.backend
        )
        decryptor = cipher.decryptor()
        padded_plaintext = decryptor.update(ciphertext) + decryptor.finalize()
        
        # Unpad
        unpadder = padding.PKCS7(128).unpadder()
        plaintext = unpadder.update(padded_plaintext) + unpadder.finalize()
        
        return plaintext.decode('utf-8')

# Usage with PostgreSQL
import psycopg2
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2

# Derive key from password (better: use KMS)
def derive_key(password: str, salt: bytes) -> bytes:
    kdf = PBKDF2(
        algorithm=hashes.SHA256(),
        length=32,
        salt=salt,
        iterations=100000,
        backend=default_backend()
    )
    return kdf.derive(password.encode())

# Initialize encryption
salt = b'unique_salt_per_app_16bytes'  # Store securely
master_password = 'your-secure-master-password'
key = derive_key(master_password, salt)
aes = AES256Encryption(key)

# Insert encrypted data
conn = psycopg2.connect("dbname=mydb user=myuser")
cursor = conn.cursor()

ssn = "123-45-6789"
credit_card = "4111-1111-1111-1111"

encrypted_ssn = aes.encrypt(ssn)
encrypted_cc = aes.encrypt(credit_card)

cursor.execute("""
    INSERT INTO customers (name, ssn_encrypted, cc_encrypted)
    VALUES (%s, %s, %s)
""", ('John Doe', encrypted_ssn, encrypted_cc))

conn.commit()

# Retrieve and decrypt
cursor.execute("SELECT ssn_encrypted, cc_encrypted FROM customers WHERE name = %s", 
               ('John Doe',))
row = cursor.fetchone()

decrypted_ssn = aes.decrypt(row[0])
decrypted_cc = aes.decrypt(row[1])

print(f"SSN: {decrypted_ssn}")
print(f"Credit Card: {decrypted_cc}")</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">5.3 Java Implementation Example</h3>
                
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">Java - Using javax.crypto</div>
                    <pre class="line-numbers"><code class="language-java">import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.GCMParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import java.security.SecureRandom;
import java.util.Base64;

public class AES256Encryption {
    private static final String ALGORITHM = "AES/GCM/NoPadding";
    private static final int GCM_TAG_LENGTH = 128;
    private static final int GCM_IV_LENGTH = 12;
    
    private final SecretKey key;
    
    public AES256Encryption(byte[] keyBytes) {
        if (keyBytes.length != 32) {
            throw new IllegalArgumentException("Key must be 32 bytes for AES-256");
        }
        this.key = new SecretKeySpec(keyBytes, "AES");
    }
    
    public String encrypt(String plaintext) throws Exception {
        // Generate random IV
        byte[] iv = new byte[GCM_IV_LENGTH];
        SecureRandom random = new SecureRandom();
        random.nextBytes(iv);
        
        // Encrypt
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        GCMParameterSpec spec = new GCMParameterSpec(GCM_TAG_LENGTH, iv);
        cipher.init(Cipher.ENCRYPT_MODE, key, spec);
        
        byte[] ciphertext = cipher.doFinal(plaintext.getBytes("UTF-8"));
        
        // Combine IV + ciphertext
        byte[] combined = new byte[iv.length + ciphertext.length];
        System.arraycopy(iv, 0, combined, 0, iv.length);
        System.arraycopy(ciphertext, 0, combined, iv.length, ciphertext.length);
        
        return Base64.getEncoder().encodeToString(combined);
    }
    
    public String decrypt(String encryptedData) throws Exception {
        byte[] combined = Base64.getDecoder().decode(encryptedData);
        
        // Extract IV and ciphertext
        byte[] iv = new byte[GCM_IV_LENGTH];
        byte[] ciphertext = new byte[combined.length - GCM_IV_LENGTH];
        System.arraycopy(combined, 0, iv, 0, iv.length);
        System.arraycopy(combined, iv.length, ciphertext, 0, ciphertext.length);
        
        // Decrypt
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        GCMParameterSpec spec = new GCMParameterSpec(GCM_TAG_LENGTH, iv);
        cipher.init(Cipher.DECRYPT_MODE, key, spec);
        
        byte[] plaintext = cipher.doFinal(ciphertext);
        return new String(plaintext, "UTF-8");
    }
    
    // Usage with PostgreSQL JDBC
    public static void main(String[] args) throws Exception {
        // Generate or load key (use KMS in production)
        KeyGenerator keyGen = KeyGenerator.getInstance("AES");
        keyGen.init(256);
        SecretKey secretKey = keyGen.generateKey();
        
        AES256Encryption aes = new AES256Encryption(secretKey.getEncoded());
        
        // Connect to PostgreSQL
        Connection conn = DriverManager.getConnection(
            "jdbc:postgresql://localhost/mydb", "user", "password");
        
        // Encrypt and insert
        String ssn = "123-45-6789";
        String encryptedSSN = aes.encrypt(ssn);
        
        PreparedStatement stmt = conn.prepareStatement(
            "INSERT INTO customers (name, ssn_encrypted) VALUES (?, ?)");
        stmt.setString(1, "Jane Doe");
        stmt.setString(2, encryptedSSN);
        stmt.executeUpdate();
        
        // Retrieve and decrypt
        ResultSet rs = conn.createStatement().executeQuery(
            "SELECT ssn_encrypted FROM customers WHERE name = 'Jane Doe'");
        
        if (rs.next()) {
            String encrypted = rs.getString("ssn_encrypted");
            String decrypted = aes.decrypt(encrypted);
            System.out.println("SSN: " + decrypted);
        }
    }
}</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">5.4 Best Practices</h3>
                <div class="space-y-3">
                    <div class="bg-gray-900 rounded p-4">
                        <h4 class="text-purple-300 font-semibold mb-2">Key Management</h4>
                        <p class="text-sm text-gray-400">Use AWS KMS, Azure Key Vault, or HashiCorp Vault for key storage. Never hardcode keys in application code.</p>
                    </div>
                    <div class="bg-gray-900 rounded p-4">
                        <h4 class="text-purple-300 font-semibold mb-2">Initialization Vectors</h4>
                        <p class="text-sm text-gray-400">Always use unique, random IVs for each encryption operation. Never reuse IVs with the same key.</p>
                    </div>
                    <div class="bg-gray-900 rounded p-4">
                        <h4 class="text-purple-300 font-semibold mb-2">Mode Selection</h4>
                        <p class="text-sm text-gray-400">Prefer GCM mode for authenticated encryption. Avoid ECB mode. Use CBC with HMAC if GCM is unavailable.</p>
                    </div>
                    <div class="bg-gray-900 rounded p-4">
                        <h4 class="text-purple-300 font-semibold mb-2">Database Design</h4>
                        <p class="text-sm text-gray-400">Store encrypted data in TEXT or BYTEA columns. Maintain separate columns for searchable metadata.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6 -->
        <section id="section6" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">6. Network/Transit Encryption (SSL/TLS)</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">6.1 SSL/TLS Configuration</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Encrypting data in transit between clients and PostgreSQL servers protects against network sniffing and 
                    man-in-the-middle attacks.
                </p>
                
                <div class="code-block rounded p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2">Generate SSL certificates</div>
                    <pre class="line-numbers"><code class="language-bash"># Generate private key (AES-256 encrypted)
openssl genrsa -aes256 -out server.key 4096

# Remove passphrase (for automatic startup)
openssl rsa -in server.key -out server.key

# Generate certificate signing request
openssl req -new -key server.key -out server.csr \
    -subj "/C=US/ST=State/L=City/O=Organization/CN=db.example.com"

# Self-sign certificate (valid 365 days)
openssl x509 -req -in server.csr -signkey server.key \
    -out server.crt -days 365

# Set proper permissions
chmod 600 server.key
chmod 644 server.crt
chown postgres:postgres server.key server.crt

# Move to PostgreSQL data directory
mv server.key server.crt /var/lib/postgresql/15/main/</code></pre>
                </div>

                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">postgresql.conf</div>
                    <pre class="line-numbers"><code class="language-properties"># Enable SSL/TLS
ssl = on
ssl_cert_file = 'server.crt'
ssl_key_file = 'server.key'
ssl_ca_file = 'root.crt'  # If using certificate authority

# Enforce strong ciphers (TLS 1.2+, AES-256)
ssl_ciphers = 'HIGH:!aNULL:!MD5:!3DES:!AES128'
ssl_prefer_server_ciphers = on
ssl_min_protocol_version = 'TLSv1.2'

# Require encryption for all connections
ssl_cert_file = '/etc/ssl/certs/server.crt'</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">6.2 pg_hba.conf Configuration</h3>
                
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">pg_hba.conf</div>
                    <pre class="line-numbers"><code class="language-properties"># Require SSL for all TCP/IP connections
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections (Unix socket)
local   all             all                                     peer

# Require SSL for remote connections
hostssl all             all             0.0.0.0/0               scram-sha-256
hostssl all             all             ::/0                    scram-sha-256

# Explicitly reject non-SSL connections
hostnossl all           all             0.0.0.0/0               reject
hostnossl all           all             ::/0                    reject

# Require client certificate authentication (mutual TLS)
hostssl all             all             10.0.0.0/8              cert clientcert=verify-full</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">6.3 Client Connection Examples</h3>
                
                <div class="code-block rounded p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2">psql command line</div>
                    <pre class="line-numbers"><code class="language-bash"># Connect with SSL required
psql "host=db.example.com port=5432 dbname=mydb user=myuser sslmode=require"

# Connect with certificate verification
psql "host=db.example.com dbname=mydb user=myuser sslmode=verify-full \
      sslcert=client.crt sslkey=client.key sslrootcert=ca.crt"

# Connection string
postgresql://<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a2cfdbd7d1c7d0e2c6c08cc7dac3cfd2cec78cc1cdcf">[email&#160;protected]</a>:5432/mydb?sslmode=verify-full</code></pre>
                </div>

                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">Python psycopg2</div>
                    <pre class="line-numbers"><code class="language-python">import psycopg2

# SSL connection
conn = psycopg2.connect(
    host="db.example.com",
    database="mydb",
    user="myuser",
    password="mypassword",
    sslmode="require",
    sslcert="/path/to/client.crt",
    sslkey="/path/to/client.key",
    sslrootcert="/path/to/ca.crt"
)</code></pre>
                </div>
            </div>
        </section>

        <!-- Section 7 -->
        <section id="section7" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">7. Column-Level Encryption with pgcrypto</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">7.1 pgcrypto Extension</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    PostgreSQL's pgcrypto extension provides built-in cryptographic functions including AES-256 encryption 
                    directly within SQL queries.
                </p>
                
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">Enable pgcrypto</div>
                    <pre class="line-numbers"><code class="language-sql">-- Enable the extension
CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- Verify installation
SELECT * FROM pg_extension WHERE extname = 'pgcrypto';</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">7.2 Symmetric Encryption (AES-256)</h3>
                
                <div class="code-block rounded p-4 mb-4">
                    <div class="text-xs text-gray-500 mb-2">SQL - Table with encrypted columns</div>
                    <pre class="line-numbers"><code class="language-sql">-- Create table with encrypted columns
CREATE TABLE customer_sensitive (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    ssn_encrypted BYTEA,
    credit_card_encrypted BYTEA,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Encryption key (store securely, not in database)
-- In production, retrieve from key management service
SET app.encryption_key = 'your-32-byte-encryption-key!!';

-- Insert with encryption (AES-256-CBC)
INSERT INTO customer_sensitive (name, ssn_encrypted, credit_card_encrypted)
VALUES (
    'John Doe',
    pgp_sym_encrypt('123-45-6789', current_setting('app.encryption_key'), 'cipher-algo=aes256'),
    pgp_sym_encrypt('4111-1111-1111-1111', current_setting('app.encryption_key'), 'cipher-algo=aes256')
);

-- Query with decryption
SELECT 
    id,
    name,
    pgp_sym_decrypt(ssn_encrypted, current_setting('app.encryption_key'))::text AS ssn,
    pgp_sym_decrypt(credit_card_encrypted, current_setting('app.encryption_key'))::text AS credit_card
FROM customer_sensitive
WHERE name = 'John Doe';</code></pre>
                </div>

                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">SQL - Using raw AES functions</div>
                    <pre class="line-numbers"><code class="language-sql">-- Raw AES-256 encryption (more control, less overhead than PGP)
CREATE OR REPLACE FUNCTION encrypt_aes256(plaintext TEXT, key TEXT)
RETURNS BYTEA AS $$
BEGIN
    RETURN encrypt(
        plaintext::bytea,
        digest(key, 'sha256'),
        'aes-cbc/pad:pkcs'
    );
END;
$$ LANGUAGE plpgsql IMMUTABLE;

CREATE OR REPLACE FUNCTION decrypt_aes256(ciphertext BYTEA, key TEXT)
RETURNS TEXT AS $$
BEGIN
    RETURN convert_from(
        decrypt(
            ciphertext,
            digest(key, 'sha256'),
            'aes-cbc/pad:pkcs'
        ),
        'utf8'
    );
END;
$$ LANGUAGE plpgsql IMMUTABLE;

-- Usage
INSERT INTO customer_sensitive (name, ssn_encrypted)
VALUES (
    'Jane Doe',
    encrypt_aes256('987-65-4321', current_setting('app.encryption_key'))
);

SELECT 
    name,
    decrypt_aes256(ssn_encrypted, current_setting('app.encryption_key')) AS ssn
FROM customer_sensitive
WHERE name = 'Jane Doe';</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">7.3 Searchable Encryption Pattern</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Since encrypted data cannot be indexed or searched directly, use hash-based lookup columns for common queries.
                </p>
                
                <div class="code-block rounded p-4">
                    <div class="text-xs text-gray-500 mb-2">SQL - Searchable encrypted columns</div>
                    <pre class="line-numbers"><code class="language-sql">CREATE TABLE customer_data (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    email_encrypted BYTEA NOT NULL,
    email_hash VARCHAR(64) NOT NULL,  -- SHA-256 hash for searching
    phone_encrypted BYTEA,
    phone_hash VARCHAR(64),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    -- Index on hash for fast lookups
    INDEX idx_email_hash (email_hash),
    INDEX idx_phone_hash (phone_hash)
);

-- Insert with encryption and hash
INSERT INTO customer_data (name, email_encrypted, email_hash, phone_encrypted, phone_hash)
VALUES (
    'Alice Smith',
    pgp_sym_encrypt('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a0c1ccc9c3c5e0c5d8c1cdd0ccc58ec3cfcd">[email&#160;protected]</a>', current_setting('app.encryption_key'), 'cipher-algo=aes256'),
    encode(digest('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="85e4e9ece6e0c5e0fde4e8f5e9e0abe6eae8">[email&#160;protected]</a>', 'sha256'), 'hex'),
    pgp_sym_encrypt('555-0123', current_setting('app.encryption_key'), 'cipher-algo=aes256'),
    encode(digest('555-0123', 'sha256'), 'hex')
);

-- Search using hash (fast, indexed)
SELECT 
    id,
    name,
    pgp_sym_decrypt(email_encrypted, current_setting('app.encryption_key'))::text AS email
FROM customer_data
WHERE email_hash = encode(digest('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3f5e53565c5a7f5a475e524f535a115c5052">[email&#160;protected]</a>', 'sha256'), 'hex');

-- Create helper function
CREATE OR REPLACE FUNCTION find_customer_by_email(search_email TEXT)
RETURNS TABLE(id INT, name VARCHAR, email TEXT, phone TEXT) AS $$
DECLARE
    email_hash_val VARCHAR(64);
BEGIN
    email_hash_val := encode(digest(search_email, 'sha256'), 'hex');
    
    RETURN QUERY
    SELECT 
        c.id,
        c.name,
        pgp_sym_decrypt(c.email_encrypted, current_setting('app.encryption_key'))::text,
        pgp_sym_decrypt(c.phone_encrypted, current_setting('app.encryption_key'))::text
    FROM customer_data c
    WHERE c.email_hash = email_hash_val;
END;
$$ LANGUAGE plpgsql;</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">7.4 Performance Considerations</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-gray-900 rounded p-4">
                        <h4 class="text-yellow-400 font-semibold mb-2">âš ï¸ Limitations</h4>
                        <ul class="text-sm text-gray-300 space-y-2">
                            <li>â€¢ Cannot index encrypted columns directly</li>
                            <li>â€¢ Full table scans for wildcard searches</li>
                            <li>â€¢ CPU overhead for encryption/decryption</li>
                            <li>â€¢ Increased storage size (10-30% overhead)</li>
                            <li>â€¢ Complex query optimization</li>
                        </ul>
                    </div>
                    <div class="bg-gray-900 rounded p-4">
                        <h4 class="text-green-400 font-semibold mb-2">âœ“ Optimizations</h4>
                        <ul class="text-sm text-gray-300 space-y-2">
                            <li>â€¢ Use hash columns for equality searches</li>
                            <li>â€¢ Encrypt only sensitive columns</li>
                            <li>â€¢ Cache decryption keys in application</li>
                            <li>â€¢ Use connection pooling</li>
                            <li>â€¢ Consider materialized views for reports</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 8 -->
        <section id="section8" class="mb-16">
            <h2 class="text-3xl font-bold text-purple-400 mb-6">8. Recommendations and Best Practices</h2>
            
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">8.1 Layered Security Approach</h3>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Implement defense-in-depth by combining multiple encryption layers:
                </p>
                
                <div class="bg-gradient-to-r from-blue-900/30 to-purple-900/30 rounded-lg p-6 border border-blue-700/50">
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-4 flex-shrink-0">1</div>
                            <div>
                                <h4 class="text-blue-300 font-semibold mb-1">Storage Layer</h4>
                                <p class="text-sm text-gray-300">LUKS or ZFS encryption for physical disk protection</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-4 flex-shrink-0">2</div>
                            <div>
                                <h4 class="text-blue-300 font-semibold mb-1">Database Layer</h4>
                                <p class="text-sm text-gray-300">TDE for automatic file-level encryption (if available)</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-4 flex-shrink-0">3</div>
                            <div>
                                <h4 class="text-blue-300 font-semibold mb-1">Column Layer</h4>
                                <p class="text-sm text-gray-300">pgcrypto or application encryption for highly sensitive fields</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-4 flex-shrink-0">4</div>
                            <div>
                                <h4 class="text-blue-300 font-semibold mb-1">Network Layer</h4>
                                <p class="text-sm text-gray-300">SSL/TLS for all client-server communications</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">8.2 Use Case Recommendations</h3>
                
                <div class="space-y-4">
                    <div class="bg-gray-900 rounded-lg p-4 border-l-4 border-green-500">
                        <h4 class="text-green-400 font-semibold mb-2">Small to Medium Deployments</h4>
                        <p class="text-sm text-gray-300 mb-2"><strong>Recommended:</strong> LUKS + SSL/TLS + pgcrypto (for PII)</p>
                        <p class="text-sm text-gray-400">Cost-effective, good performance, uses standard Linux tools</p>
                    </div>
                    
                    <div class="bg-gray-900 rounded-lg p-4 border-l-4 border-blue-500">
                        <h4 class="text-blue-400 font-semibold mb-2">Enterprise Deployments</h4>
                        <p class="text-sm text-gray-300 mb-2"><strong>Recommended:</strong> TDE + SSL/TLS + Application-level encryption</p>
                        <p class="text-sm text-gray-400">Comprehensive protection, managed keys with KMS integration</p>
                    </div>
                    
                    <div class="bg-gray-900 rounded-lg p-4 border-l-4 border-purple-500">
                        <h4 class="text-purple-400 font-semibold mb-2">High-Performance Systems</h4>
                        <p class="text-sm text-gray-300 mb-2"><strong>Recommended:</strong> ZFS native encryption + SSL/TLS</p>
                        <p class="text-sm text-gray-400">Minimal overhead, excellent throughput with hardware AES support</p>
                    </div>
                    
                    <div class="bg-gray-900 rounded-lg p-4 border-l-4 border-orange-500">
                        <h4 class="text-orange-400 font-semibold mb-2">Regulatory Compliance (HIPAA, PCI-DSS)</h4>
                        <p class="text-sm text-gray-300 mb-2"><strong>Recommended:</strong> Full stack encryption (all layers)</p>
                        <p class="text-sm text-gray-400">Defense-in-depth with audit trails and key rotation</p>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">8.3 Key Management Best Practices</h3>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="space-y-3">
                        <div class="bg-gray-900 rounded p-3">
                            <h5 class="text-purple-300 font-semibold text-sm mb-1">âœ“ DO</h5>
                            <ul class="text-xs text-gray-400 space-y-1">
                                <li>â€¢ Use hardware security modules (HSM) or cloud KMS</li>
                                <li>â€¢ Implement automatic key rotation (90-180 days)</li>
                                <li>â€¢ Maintain separate keys per environment</li>
                                <li>â€¢ Use envelope encryption for data keys</li>
                                <li>â€¢ Log all key access with audit trails</li>
                                <li>â€¢ Store keys separately from encrypted data</li>
                                <li>â€¢ Implement key versioning for rotation</li>
                            </ul>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="bg-gray-900 rounded p-3">
                            <h5 class="text-red-300 font-semibold text-sm mb-1">âœ— DON'T</h5>
                            <ul class="text-xs text-gray-400 space-y-1">
                                <li>â€¢ Hardcode keys in application code</li>
                                <li>â€¢ Store keys in version control systems</li>
                                <li>â€¢ Use the same key across environments</li>
                                <li>â€¢ Store keys in the database itself</li>
                                <li>â€¢ Share keys via email or messaging</li>
                                <li>â€¢ Use weak or predictable keys</li>
                                <li>â€¢ Forget to backup encryption keys securely</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">8.4 Performance Impact Summary</h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-900 border-b border-gray-700">
                            <tr>
                                <th class="text-left p-3 text-blue-300">Encryption Method</th>
                                <th class="text-left p-3 text-blue-300">CPU Overhead</th>
                                <th class="text-left p-3 text-blue-300">Storage Overhead</th>
                                <th class="text-left p-3 text-blue-300">Query Performance</th>
                                <th class="text-left p-3 text-blue-300">Best For</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700">
                            <tr>
                                <td class="p-3 text-gray-300 font-medium">LUKS/Disk</td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">1-3%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">~0%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">Minimal</span></td>
                                <td class="p-3 text-gray-400 text-xs">General purpose</td>
                            </tr>
                            <tr>
                                <td class="p-3 text-gray-300 font-medium">ZFS Native</td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">2-5%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">~0%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">Minimal</span></td>
                                <td class="p-3 text-gray-400 text-xs">High performance</td>
                            </tr>
                            <tr>
                                <td class="p-3 text-gray-300 font-medium">TDE</td>
                                <td class="p-3"><span class="px-2 py-1 bg-yellow-900 text-yellow-300 rounded text-xs">5-15%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">~0%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">Minimal</span></td>
                                <td class="p-3 text-gray-400 text-xs">Enterprise</td>
                            </tr>
                            <tr>
                                <td class="p-3 text-gray-300 font-medium">pgcrypto Column</td>
                                <td class="p-3"><span class="px-2 py-1 bg-orange-900 text-orange-300 rounded text-xs">15-30%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-yellow-900 text-yellow-300 rounded text-xs">10-30%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-orange-900 text-orange-300 rounded text-xs">Moderate</span></td>
                                <td class="p-3 text-gray-400 text-xs">Selective data</td>
                            </tr>
                            <tr>
                                <td class="p-3 text-gray-300 font-medium">Application-Level</td>
                                <td class="p-3"><span class="px-2 py-1 bg-red-900 text-red-300 rounded text-xs">Variable</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-yellow-900 text-yellow-300 rounded text-xs">10-30%</span></td>
                                <td class="p-3"><span class="px-2 py-1 bg-red-900 text-red-300 rounded text-xs">High impact</span></td>
                                <td class="p-3 text-gray-400 text-xs">Maximum control</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="bg-gradient-to-br from-purple-900/30 to-blue-900/30 rounded-lg p-6 border border-purple-800/50">
                <h3 class="text-xl font-semibold text-purple-300 mb-4">8.5 Decision Framework</h3>
                <div class="space-y-3 text-sm text-gray-300">
                    <p><strong class="text-blue-300">Ask yourself:</strong></p>
                    <div class="pl-4 space-y-2">
                        <p>1. <strong>What data needs protection?</strong> (All data vs. specific sensitive fields)</p>
                        <p>2. <strong>What threats are you protecting against?</strong> (Physical theft, insider threats, network attacks)</p>
                        <p>3. <strong>What's your performance tolerance?</strong> (Real-time OLTP vs. analytics workloads)</p>
                        <p>4. <strong>What compliance requirements apply?</strong> (HIPAA, PCI-DSS, GDPR, SOX)</p>
                        <p>5. <strong>What's your key management capability?</strong> (Simple file-based vs. enterprise KMS)</p>
                        <p>6. <strong>What's your budget?</strong> (Open source vs. enterprise solutions)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="mb-16">
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg p-8 border border-gray-700">
                <h2 class="text-3xl font-bold text-purple-400 mb-6">Conclusion</h2>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Implementing AES-256 encryption in PostgreSQL requires careful consideration of security requirements, 
                    performance constraints, and operational complexity. No single encryption approach fits all scenarios; 
                    the optimal strategy often combines multiple layers of protection.
                </p>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Organizations should begin with encryption at rest (disk-level) and in transit (SSL/TLS) as foundational 
                    protections. Additional application-level or column-level encryption should be implemented for highly 
                    sensitive data that requires protection even from database administrators.
                </p>
                <p class="text-gray-300 leading-relaxed">
                    Regular security audits, proper key management practices, and staying current with PostgreSQL security 
                    updates remain critical components of any database encryption strategy. Remember: encryption is one piece 
                    of a comprehensive security program that includes access controls, monitoring, backup procedures, and 
                    incident response planning.
                </p>
            </div>
        </section>

        <!-- References -->
        <section class="mb-16">
            <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
                <h3 class="text-2xl font-bold text-blue-400 mb-4">References</h3>
                <ul class="space-y-2 text-sm text-gray-300">
                    <li>â€¢ PostgreSQL Documentation: <a href="https://www.postgresql.org/docs/" target="_blank" class="text-blue-400 hover:text-blue-300 underline">https://www.postgresql.org/docs/</a></li>
                    <li>â€¢ NIST AES Standard (FIPS 197): <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf" target="_blank" class="text-blue-400 hover:text-blue-300 underline">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf</a></li>
                    <li>â€¢ pgcrypto Extension: <a href="https://www.postgresql.org/docs/current/pgcrypto.html" target="_blank" class="text-blue-400 hover:text-blue-300 underline">https://www.postgresql.org/docs/current/pgcrypto.html</a></li>
                    <li>â€¢ LUKS Documentation: <a href="https://gitlab.com/cryptsetup/cryptsetup" target="_blank" class="text-blue-400 hover:text-blue-300 underline">https://gitlab.com/cryptsetup/cryptsetup</a></li>
                    <li>â€¢ OpenSSL Documentation: <a href="https://www.openssl.org/docs/" target="_blank" class="text-blue-400 hover:text-blue-300 underline">https://www.openssl.org/docs/</a></li>
                    <li>â€¢ OWASP Cryptographic Storage Cheat Sheet: <a href="https://cheatsheetseries.owasp.org/" target="_blank" class="text-blue-400 hover:text-blue-300 underline">https://cheatsheetseries.owasp.org/</a></li>
                </ul>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 border-t border-gray-700 mt-16">
        <div class="max-w-6xl mx-auto px-6 py-8">
            <div class="text-center text-gray-400 text-sm">
                <p class="mb-2">Â© 2026 PostgreSQL AES-256 Encryption White Paper</p>
                <p>This document is provided for informational purposes. Always consult security professionals for production implementations.</p>
            </div>
        </div>
    </footer>

    <!-- Prism.js Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-properties.min.js"></script>

</body>
</html>