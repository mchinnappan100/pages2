<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandbox Refresh Checklist Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico" />
    <style>
        .dark {
            color-scheme: dark;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto">
            <!-- Header -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Sandbox Refresh Checklist</h1>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">Track your pre-refresh preparation tasks</p>
                    </div>
                    <button id="themeToggle" style="display: none;" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        <svg class="w-6 h-6 text-gray-800 dark:text-gray-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path class="sun" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                            <path class="moon hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Import/Export Buttons -->
                <div class="flex gap-3 mt-4">
                    <button id="exportBtn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                        </svg>
                        Export Progress
                    </button>
                    <label class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2 cursor-pointer">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                        </svg>
                        Import Progress
                        <input type="file" id="importBtn" accept=".json" class="hidden">
                    </label>
                    <button id="resetBtn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        Reset All
                    </button>
                </div>
            </div>

            <!-- Progress Overview -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Progress Overview</h2>
                <div class="flex items-center gap-4">
                    <div class="flex-1">
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4">
                            <div id="progressBar" class="bg-blue-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="text-2xl font-bold text-gray-900 dark:text-white">
                        <span id="progressText">0/6</span>
                    </div>
                </div>
            </div>

            <!-- Checklist Items -->
            <div id="checklistContainer" class="space-y-4">
                <!-- Items will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // In-memory data storage
        let checklistData = [
            {
                id: 1,
                task: "Back up any sandbox-specific customizations or test data you need to preserve",
                description: "Back up PCM and DRO related data. Salesforce Data Extractor (https://www.npmjs.com/package/sf-data-extractor) can be used for the backup",
                completed: false,
                completedBy: "",
                completedDate: "",
                comments: ""
            },
            {
                id: 2,
                task: "Document all connected app configurations and consumer keys",
                description: "Connected Apps with Consumer Keys and OAuth integrations must be reconfigured after refresh",
                completed: false,
                completedBy: "",
                completedDate: "",
                comments: ""
            },
            {
                id: 3,
                task: "Export any reports or dashboards unique to the sandbox",
                description: "Save any custom reports or dashboards that exist only in the sandbox environment",
                completed: false,
                completedBy: "",
                completedDate: "",
                comments: ""
            },
            {
                id: 4,
                task: "Notify team members about the upcoming refresh and downtime",
                description: "Ensure all stakeholders are aware of the maintenance window and potential impact",
                completed: false,
                completedBy: "",
                completedDate: "",
                comments: ""
            },
            {
                id: 5,
                task: "Save credentials and endpoints for external systems",
                description: "Named Credentials and external system credentials need to be re-entered after refresh",
                completed: false,
                completedBy: "",
                completedDate: "",
                comments: ""
            },
            {
                id: 6,
                task: "Schedule the refresh during a maintenance window",
                description: "Plan the refresh during a time that minimizes impact on team productivity",
                completed: false,
                completedBy: "",
                completedDate: "",
                comments: ""
            }
        ];

        // Theme management
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const sunIcon = document.querySelector('.sun');
        const moonIcon = document.querySelector('.moon');

        let isDark = false;

        themeToggle.addEventListener('click', () => {
            isDark = !isDark;
            if (isDark) {
                html.classList.add('dark');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            } else {
                html.classList.remove('dark');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            }
        });

        // Render checklist
        function renderChecklist() {
            const container = document.getElementById('checklistContainer');
            container.innerHTML = '';

            checklistData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 transition-all duration-200';
                
                card.innerHTML = `
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 pt-1">
                            <input type="checkbox" 
                                   id="check-${item.id}" 
                                   ${item.completed ? 'checked' : ''} 
                                   class="w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500 cursor-pointer">
                        </div>
                        <div class="flex-1">
                            <label for="check-${item.id}" class="cursor-pointer">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white ${item.completed ? 'line-through opacity-60' : ''}">
                                    ${item.task}
                                </h3>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">${item.description}</p>
                            </label>
                            
                            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Completed By</label>
                                    <input type="text" 
                                           value="${item.completedBy}" 
                                           placeholder="Enter name"
                                           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                           data-id="${item.id}" 
                                           data-field="completedBy">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Completed Date</label>
                                    <input type="date" 
                                           value="${item.completedDate}" 
                                           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                           data-id="${item.id}" 
                                           data-field="completedDate">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Comments</label>
                                <textarea 
                                    placeholder="Add any notes or comments..."
                                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                    rows="2"
                                    data-id="${item.id}" 
                                    data-field="comments">${item.comments}</textarea>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });

            updateProgress();
            attachEventListeners();
        }

        // Update progress bar
        function updateProgress() {
            const completed = checklistData.filter(item => item.completed).length;
            const total = checklistData.length;
            const percentage = (completed / total) * 100;
            
            document.getElementById('progressBar').style.width = `${percentage}%`;
            document.getElementById('progressText').textContent = `${completed}/${total}`;
        }

        // Attach event listeners
        function attachEventListeners() {
            // Checkbox listeners
            checklistData.forEach(item => {
                const checkbox = document.getElementById(`check-${item.id}`);
                if (checkbox) {
                    checkbox.addEventListener('change', (e) => {
                        item.completed = e.target.checked;
                        renderChecklist();
                    });
                }
            });

            // Input field listeners
            document.querySelectorAll('input[data-field], textarea[data-field]').forEach(input => {
                input.addEventListener('input', (e) => {
                    const id = parseInt(e.target.dataset.id);
                    const field = e.target.dataset.field;
                    const itemIndex = checklistData.findIndex(item => item.id === id);
                    
                    if (itemIndex !== -1) {
                        checklistData[itemIndex][field] = e.target.value;
                    }
                });
            });
        }

        // Export functionality
        document.getElementById('exportBtn').addEventListener('click', () => {
            const dataStr = JSON.stringify(checklistData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `sandbox-refresh-checklist-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        });

        // Import functionality
        document.getElementById('importBtn').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const imported = JSON.parse(event.target.result);
                        if (Array.isArray(imported) && imported.length > 0) {
                            checklistData = imported;
                            renderChecklist();
                            alert('Checklist imported successfully!');
                        } else {
                            alert('Invalid checklist format');
                        }
                    } catch (error) {
                        alert('Error importing file: ' + error.message);
                    }
                };
                reader.readAsText(file);
            }
            e.target.value = '';
        });

        // Reset functionality
        document.getElementById('resetBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                checklistData.forEach(item => {
                    item.completed = false;
                    item.completedBy = '';
                    item.completedDate = '';
                    item.comments = '';
                });
                renderChecklist();
            }
        });

        // Initial render
        renderChecklist();
    </script>
</body>
</html>